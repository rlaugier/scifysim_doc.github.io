
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>scifysim package &#8212; SCIFYsim 0.2.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SCIFYsim 0.2.2 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">scifysim package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="scifysim-package">
<h1>scifysim package<a class="headerlink" href="#scifysim-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="scifysim-analysis-module">
<h2>scifysim.analysis module<a class="headerlink" href="#scifysim-analysis-module" title="Permalink to this headline">¶</a></h2>
</section>
<section id="scifysim-bimorph-module">
<h2>scifysim.bimorph module<a class="headerlink" href="#scifysim-bimorph-module" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-scifysim.combiner">
<span id="scifysim-combiner-module"></span><h2>scifysim.combiner module<a class="headerlink" href="#module-scifysim.combiner" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="scifysim.combiner.combiner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.combiner.</span></span><span class="sig-name descname"><span class="pre">combiner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thesubs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_bright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_dark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_photometric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiner.combiner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.combiner.combiner.angel_woolf">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">angel_woolf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph_shifters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">pi</span> <span class="pre">/</span> <span class="pre">2)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiner.combiner.angel_woolf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.combiner.combiner.chromatic_matrix">
<span class="sig-name descname"><span class="pre">chromatic_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiner.combiner.chromatic_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Work in progress. This helps define the chromatic behaviour of the combiner even
when it is define achromatic.</p>
<ul class="simple">
<li><p>wl      : An array of wavelengths for which to compute the matrix</p></li>
</ul>
<p>Several matrices are stored in <cite>combiner</cite>
* self.Mcs    : a symbolic formula for the combiner matrix (2D sympy array)</p>
<blockquote>
<div><p>as a function of the wavenumber k</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>self.Mcl<span class="classifier">The matrix as a lambda-function of (k, 0) </span></dt><dd><p>The extra 0 parameter passed helps to cast the correct shape</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>self.Mcn<span class="classifier">The numpy ndarray of the matrix of interest</span></dt><dd><p>shape is (n_wl, n_out, n_in)</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.combiner.combiner.from_config">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph_shifters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiner.combiner.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>file         : The config file
ph_shifters  : Phase shifters between first and second stage default: (0,0)</p>
<blockquote>
<div><p>These correspond to the “internal modulation”</p>
</div></blockquote>
<p>Accepted combiners:
angel_woolf_ph, VIKiNG, GLINT, GRAVITY, bracewell_ph, bracewell</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.combiner.combiner.pseudo_chromatic_matrix">
<span class="sig-name descname"><span class="pre">pseudo_chromatic_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiner.combiner.pseudo_chromatic_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Work in progress. This helps define the chromatic behaviour of the combiner even
when it is define achromatic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.combiner.combiner.refresh_array">
<span class="sig-name descname"><span class="pre">refresh_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thearray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiner.combiner.refresh_array" title="Permalink to this definition">¶</a></dt>
<dd><p>This method recomputes a disposable encapsulated function for the give pointing.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiner.test_angel_woolf">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiner.</span></span><span class="sig-name descname"><span class="pre">test_angel_woolf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiner.test_angel_woolf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiner.test_combiner">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiner.</span></span><span class="sig-name descname"><span class="pre">test_combiner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">combiner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiner.test_combiner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-scifysim.combiners">
<span id="scifysim-combiners-module"></span><h2>scifysim.combiners module<a class="headerlink" href="#module-scifysim.combiners" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.ABCD">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">ABCD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Matrix([[sqrt(2)</span> <span class="pre">/</span> <span class="pre">2,</span> <span class="pre">sqrt(2)</span> <span class="pre">/</span> <span class="pre">2],</span> <span class="pre">[-</span> <span class="pre">sqrt(2)</span> <span class="pre">*</span> <span class="pre">I</span> <span class="pre">/</span> <span class="pre">2,</span> <span class="pre">sqrt(2)</span> <span class="pre">*</span> <span class="pre">I</span> <span class="pre">/</span> <span class="pre">2]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph_shifter_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'achromatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.ABCD" title="Permalink to this definition">¶</a></dt>
<dd><p>Build an ABCD combiner.</p>
<p>Returns: the sympy.Matrix of the combiner
Free symbols can be retrieved in list(M.free_symbols)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.GLINT">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">GLINT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tap_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.GLINT" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a 4 input baseline-wise Bracewell combiner
similar in principle to the one used in GLINT.</p>
<p>Returns: the sympy.Matrix of the combiner
Free symbols can be retrieved in list(M.free_symbols)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.GRAVITY">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">GRAVITY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Matrix([[sqrt(2)</span> <span class="pre">/</span> <span class="pre">2,</span> <span class="pre">sqrt(2)</span> <span class="pre">/</span> <span class="pre">2],</span> <span class="pre">[-</span> <span class="pre">sqrt(2)</span> <span class="pre">*</span> <span class="pre">I</span> <span class="pre">/</span> <span class="pre">2,</span> <span class="pre">sqrt(2)</span> <span class="pre">*</span> <span class="pre">I</span> <span class="pre">/</span> <span class="pre">2]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph_shifter_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'achromatic'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.GRAVITY" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a 4 input baseline-wise ABCD combiner
similar in principle to the one used in GRAVITY.
E&#64;D&#64;C&#64;B&#64;A</p>
<p>Returns: the sympy.Matrix of the combiner
Free symbols can be retrieved in list(M.free_symbols)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.VIKiNG">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">VIKiNG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ph_shifters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tap_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.VIKiNG" title="Permalink to this definition">¶</a></dt>
<dd><p>optional :
ph_shifters : a list of phase shifters in between the 2 stages</p>
<blockquote>
<div><p>(eg: for kernel-nuller ph_shifters=[0, sp.pi/2])</p>
</div></blockquote>
<dl class="simple">
<dt>include_masks: If true, the output will include bright, dark and photometric masks</dt><dd><p>selecting the relevant outputs</p>
</dd>
</dl>
<p>in: 4
out: 8 (ph0, ph1, bright0, dark0, dark1, bright1, ph2, ph3)
symbols:</p>
<blockquote>
<div><p>sigma  : the photometric ratio (in intensity)
phi_0   : the phase shifter1
phi_1   : the phase shifter2</p>
</div></blockquote>
<p>Build a bracewell combiner with photometric outputs.</p>
<p>Returns: the sympy.Matrix of the combiner
Free symbols can be retrieved in list(M.free_symbols)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.angel_woolf_ph">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">angel_woolf_ph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ph_shifters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tap_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.angel_woolf_ph" title="Permalink to this definition">¶</a></dt>
<dd><p>optional :
ph_shifters : a list of phase shifters in between the 2 stages</p>
<blockquote>
<div><p>(eg: for kernel-nuller ph_shifters=[0, sp.pi/2])</p>
</div></blockquote>
<dl class="simple">
<dt>include_masks: If true, the output will include bright, dark and photometric masks</dt><dd><p>selecting the relevant outputs</p>
</dd>
</dl>
<p>in: 4
out: 8 (ph0, ph1, bright0, dark0, dark1, bright1, ph2, ph3)
symbols:</p>
<blockquote>
<div><p>sigma  : the photometric ratio (in intensity)
phi_0   : the phase shifter1
phi_1   : the phase shifter2</p>
</div></blockquote>
<p>Build a bracewell combiner with photometric outputs.</p>
<p>Returns: the sympy.Matrix of the combiner
Free symbols can be retrieved in list(M.free_symbols)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.angel_woolf_ph_chromatic">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">angel_woolf_ph_chromatic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ph_shifters=None,</span> <span class="pre">include_masks=False,</span> <span class="pre">offset=True,</span> <span class="pre">tap_ratio=None,</span> <span class="pre">Mc=Matrix([</span> <span class="pre">[</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">5.96043014685912e+35*sqrt(-3.11899173008594e-27*lambda</span> <span class="pre">+</span> <span class="pre">(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">-</span> <span class="pre">2.17053912230413e-5*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">+</span> <span class="pre">1.9282898951409e-10*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">-</span> <span class="pre">8.97370643504022e-16*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">+</span> <span class="pre">2.30849483140184e-21*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">+</span> <span class="pre">1.49124427302617e-33)*sqrt(5.77997551361171e-27*lambda</span> <span class="pre">-</span> <span class="pre">(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">+</span> <span class="pre">2.40871778439492e-5*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">-</span> <span class="pre">2.39874630703312e-10*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">+</span> <span class="pre">1.26391490908348e-15*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">-</span> <span class="pre">3.71594217139645e-21*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">-</span> <span class="pre">3.25387788553213e-33),</span> <span class="pre">-5.96043014685912e+35*sqrt(3.11899173008594e-27*lambda</span> <span class="pre">-</span> <span class="pre">(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">+</span> <span class="pre">2.17053912230413e-5*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">-</span> <span class="pre">1.9282898951409e-10*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">+</span> <span class="pre">8.97370643504022e-16*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">-</span> <span class="pre">2.30849483140184e-21*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">-</span> <span class="pre">1.48545535819313e-33)*sqrt(5.77997551361171e-27*lambda</span> <span class="pre">-</span> <span class="pre">(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">+</span> <span class="pre">2.40871778439492e-5*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">-</span> <span class="pre">2.39874630703312e-10*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">+</span> <span class="pre">1.26391490908348e-15*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">-</span> <span class="pre">3.71594217139645e-21*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">-</span> <span class="pre">3.25387788553213e-33)*exp(-I*(pi*(8385360298.472*lambda</span> <span class="pre">+</span> <span class="pre">1.2036866257e+36*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">-</span> <span class="pre">2.73368521128e+31*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">+</span> <span class="pre">2.003471800676e+26*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">-</span> <span class="pre">3.770537163354e+20*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">-</span> <span class="pre">1.7476266395813e+15*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">-</span> <span class="pre">8914.38427432924)/180</span> <span class="pre">-</span> <span class="pre">pi))],</span> <span class="pre">[5.96043014685912e+35*sqrt(3.11899173008594e-27*lambda</span> <span class="pre">-</span> <span class="pre">(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">+</span> <span class="pre">2.17053912230413e-5*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">-</span> <span class="pre">1.9282898951409e-10*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">+</span> <span class="pre">8.97370643504022e-16*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">-</span> <span class="pre">2.30849483140184e-21*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">-</span> <span class="pre">1.48545535819313e-33)*sqrt(5.77997551361171e-27*lambda</span> <span class="pre">-</span> <span class="pre">(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">+</span> <span class="pre">2.40871778439492e-5*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">-</span> <span class="pre">2.39874630703312e-10*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">+</span> <span class="pre">1.26391490908348e-15*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">-</span> <span class="pre">3.71594217139645e-21*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">-</span> <span class="pre">3.25387788553213e-33)*exp(I*(pi*(8385360298.472*lambda</span> <span class="pre">+</span> <span class="pre">1.2036866257e+36*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">-</span> <span class="pre">2.73368521128e+31*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">+</span> <span class="pre">2.003471800676e+26*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">-</span> <span class="pre">3.770537163354e+20*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">-</span> <span class="pre">1.7476266395813e+15*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">-</span> <span class="pre">8914.38427432924)/180</span> <span class="pre">-</span> <span class="pre">pi)),</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">5.96043014685912e+35*sqrt(-3.11899173008594e-27*lambda</span> <span class="pre">+</span> <span class="pre">(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">-</span> <span class="pre">2.17053912230413e-5*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">+</span> <span class="pre">1.9282898951409e-10*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">-</span> <span class="pre">8.97370643504022e-16*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">+</span> <span class="pre">2.30849483140184e-21*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">+</span> <span class="pre">1.49124427302617e-33)*sqrt(5.77997551361171e-27*lambda</span> <span class="pre">-</span> <span class="pre">(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**6</span> <span class="pre">+</span> <span class="pre">2.40871778439492e-5*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**5</span> <span class="pre">-</span> <span class="pre">2.39874630703312e-10*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**4</span> <span class="pre">+</span> <span class="pre">1.26391490908348e-15*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**3</span> <span class="pre">-</span> <span class="pre">3.71594217139645e-21*(lambda</span> <span class="pre">+</span> <span class="pre">8.0e-8)**2</span> <span class="pre">-</span> <span class="pre">3.25387788553213e-33)]]),</span> <span class="pre">input_ph_shifters=None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.angel_woolf_ph_chromatic" title="Permalink to this definition">¶</a></dt>
<dd><p>optional :
ph_shifters : a list of phase shifters in between the 2 stages</p>
<blockquote>
<div><p>(eg: for kernel-nuller ph_shifters=[0, sp.pi/2])</p>
</div></blockquote>
<dl class="simple">
<dt>include_masks: If true, the output will include bright, dark and photometric masks</dt><dd><p>selecting the relevnant outputs</p>
</dd>
</dl>
<p>Mc          : The chromatic combiner model default: M_KG</p>
<p>in: 4
out: 8 (ph0, ph1, bright0, dark0, dark1, bright1, ph2, ph3)
symbols:</p>
<blockquote>
<div><p>sigma  : the photometric ratio (in intensity)
phi_0   : the phase shifter1
phi_1   : the phase shifter2</p>
</div></blockquote>
<p>Build a bracewell combiner with photometric outputs.</p>
<p>Returns: the sympy.Matrix of the combiner
Free symbols can be retrieved in list(M.free_symbols)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.bracewell_ph">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">bracewell_ph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tap_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.bracewell_ph" title="Permalink to this definition">¶</a></dt>
<dd><p>in: 2
out: 4 (ph0, bright, dark, ph1)
symbols:</p>
<blockquote>
<div><p>sigma  : the photometric ratio (in intensity)</p>
</div></blockquote>
<p>Build a bracewell combiner with photometric outputs.</p>
<p>Returns: the sympy.Matrix of the combiner M
Free symbols can be retrieved in list(M.free_symbols)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.four2six">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">four2six</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.four2six" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.four_photometric">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">four_photometric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tap_ratio</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.four_photometric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.geom_ph_shifter">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">geom_ph_shifter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.geom_ph_shifter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.ph_shifter">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">ph_shifter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.ph_shifter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.piston2phase">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">piston2phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.piston2phase" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.combiners.test_combiners">
<span class="sig-prename descclassname"><span class="pre">scifysim.combiners.</span></span><span class="sig-name descname"><span class="pre">test_combiners</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.combiners.test_combiners" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="scifysim-confconverter-module">
<h2>scifysim.confconverter module<a class="headerlink" href="#scifysim-confconverter-module" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-scifysim.control_loop">
<span id="scifysim-control-loop-module"></span><h2>scifysim.control_loop module<a class="headerlink" href="#module-scifysim.control_loop" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scifysim.control_loop.Nyquist">
<span class="sig-prename descclassname"><span class="pre">scifysim.control_loop.</span></span><span class="sig-name descname"><span class="pre">Nyquist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">getfig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.Nyquist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.control_loop.amp2dB">
<span class="sig-prename descclassname"><span class="pre">scifysim.control_loop.</span></span><span class="sig-name descname"><span class="pre">amp2dB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.amp2dB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.control_loop.bode">
<span class="sig-prename descclassname"><span class="pre">scifysim.control_loop.</span></span><span class="sig-name descname"><span class="pre">bode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">getfig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.bode" title="Permalink to this definition">¶</a></dt>
<dd><p>Just a shortcut to plot a bunch of Bode plots easily
f     : Hz n_samples np.array The frequency samples
H     :    array-like containing either:</p>
<blockquote>
<div><p>One array of amplitudes
n_series x n_samples (2D array)</p>
</div></blockquote>
<p>Plots the Bode plot</p>
<p>Note: future improvements: option to save the plots or return the figure.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.control_loop.control_loop">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.control_loop.</span></span><span class="sig-name descname"><span class="pre">control_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">50000.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dif</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_sens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_late</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_dac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctrl_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.control_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.control_loop.control_loop.cleanup">
<span class="sig-name descname"><span class="pre">cleanup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.control_loop.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Can use this method to remove unnecessary memory usage.
Will remove self.H_sens,  self.H_act, self.H_late, self.H_dac
and leave only self.H_ctrl and self.TF_openloop</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.control_loop.control_loop.getplots">
<span class="sig-name descname"><span class="pre">getplots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plottype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bode'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.control_loop.getplots" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a few nice plots of for the controler</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.control_loop.control_loop.margins">
<span class="sig-name descname"><span class="pre">margins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gain</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.control_loop.margins" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.control_loop.dB2amp">
<span class="sig-prename descclassname"><span class="pre">scifysim.control_loop.</span></span><span class="sig-name descname"><span class="pre">dB2amp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gain</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.dB2amp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.control_loop.get_error_from_margins">
<span class="sig-prename descclassname"><span class="pre">scifysim.control_loop.</span></span><span class="sig-name descname"><span class="pre">get_error_from_margins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amargin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmargin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_pmar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_amar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.get_error_from_margins" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.control_loop.set_logging_level">
<span class="sig-prename descclassname"><span class="pre">scifysim.control_loop.</span></span><span class="sig-name descname"><span class="pre">set_logging_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.set_logging_level" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.control_loop.test_error_margins">
<span class="sig-prename descclassname"><span class="pre">scifysim.control_loop.</span></span><span class="sig-name descname"><span class="pre">test_error_margins</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.control_loop.test_error_margins" title="Permalink to this definition">¶</a></dt>
<dd><p>Test harness for the margins cost function
Plots a map of the error returned by get_error_from_margins()</p>
</dd></dl>

</section>
<section id="module-scifysim.correctors">
<span id="scifysim-correctors-module"></span><h2>scifysim.correctors module<a class="headerlink" href="#module-scifysim.correctors" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="scifysim.correctors.corrector">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.correctors.</span></span><span class="sig-name descname"><span class="pre">corrector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.corrector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.correctors.corrector.get_phasor">
<span class="sig-name descname"><span class="pre">get_phasor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.corrector.get_phasor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the complex phasor corresponding
to the current a, b, c, and dcomp phasors.</p>
<p>lambs :     The wavelength channels to consider [m]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.correctors.corrector.get_phasor_from_params">
<span class="sig-name descname"><span class="pre">get_phasor_from_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dcomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.corrector.get_phasor_from_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to get_phasor() but allows to provide the
parameters as arguments (slower).</p>
<p>Returns the complex phasor corresponding
to the current a, b, c, and dcomp phasors.</p>
<p>lambs :     The wavelength channels to consider [m]
a     :     Vector of the amplitude term
b     :     Vetor of the geometric piston term [m]
c     :     Vetor of the dispersive piston term [m]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.correctors.corrector.get_phasor_s">
<span class="sig-name descname"><span class="pre">get_phasor_s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lamb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.corrector.get_phasor_s" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.correctors.corrector.plot_tuning">
<span class="sig-name descname"><span class="pre">plot_tuning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.corrector.plot_tuning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.correctors.corrector.solve_air">
<span class="sig-name descname"><span class="pre">solve_air</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wet_atmo</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.corrector.solve_air" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a least squares compensation model (see
Koresko et al. 2003 DOI: 10.1117/12.458032)</p>
<p>lambs :     The wavelength channels to consider [m]
wet_atmo   : The wet atmosphere model (see n_air.wet_atmo object)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.correctors.corrector.theoretical_phase">
<span class="sig-name descname"><span class="pre">theoretical_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_opds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wet_atmo</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.corrector.theoretical_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the theoretical chromatic phase effect of the
array geometry projected on axis based on the wet atmosphere
model.</p>
<p>lambs :     The wavelength channels to consider [m]
proj_opds  : The projected piston obtained by projection</p>
<blockquote>
<div><p>(Get from simulator.obs.get_projected_geometric_pistons)</p>
</div></blockquote>
<p>wet_atmo   : The wet atmosphere model (see n_air.wet_atmo object)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.correctors.corrector.tune_static">
<span class="sig-name descname"><span class="pre">tune_static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combiner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freeze_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['b0',</span> <span class="pre">'c0',</span> <span class="pre">'b2',</span> <span class="pre">'c2']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.corrector.tune_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize the compensator to correct chromatism in the 
model of the combiner. Returns a lmfit solution object.
If “apply” is set to True, a, b, c, and dcomp are also
set to the best fit value.</p>
<p>lambs :     The wavelength channels to consider [m]
combiner :  A combiner object (chromatic)  
apply    :  Boolean deciding whether to set the local</p>
<blockquote>
<div><p>parameters to best fit value (default: True)</p>
</div></blockquote>
<dl class="simple">
<dt>freeze_params<span class="classifier">The name of parameters to be freezed.</span></dt><dd><p>Should be used to account for the larger than
necessary number of degrees of freedom.</p>
</dd>
</dl>
<p>Note: For obtaining a more practical direct results, some
more complicated balancing guidelines should be followed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.correctors.corrector.tune_static_shape">
<span class="sig-name descname"><span class="pre">tune_static_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combiner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[('b3',</span> <span class="pre">'b2',</span> <span class="pre">0.0),</span> <span class="pre">('c3',</span> <span class="pre">'c2',</span> <span class="pre">0.0)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freeze_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['b0',</span> <span class="pre">'c0',</span> <span class="pre">'b1',</span> <span class="pre">'c1']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.corrector.tune_static_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize the compensator to correct chromatism in the 
model of the combiner to obtain enantomporph combinations
at the outputs. Returns a lmfit solution object.
If “apply” is set to True, a, b, c, and dcomp are also
set to the best fit value.</p>
<p><strong>Currently only works for double Bracewell 3-4 architectures.</strong></p>
<p>lambs :     The wavelength channels to consider [m]
combiner :  A combiner object (chromatic)  
apply    :  Boolean deciding whether to set the local</p>
<blockquote>
<div><p>parameters to best fit value (default: True)</p>
</div></blockquote>
<p>Note: For obtaining a more practical direct results, some
more complicated balancing guidelines should be followed.</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>`
sol = asim.corrector.tune_static_shape(asim.lambda_science_range,</p>
<blockquote>
<div><p>asim.combiner,
sync_params=[(“b3”, “b2”, asim.corrector.b[3] - asim.corrector.b[2]),</p>
<blockquote>
<div><p>(“c3”, “c2”, asim.corrector.c[3] - asim.corrector.c[2])],</p>
</div></blockquote>
<p>apply=True)</p>
</div></blockquote>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a></p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.correctors.extract_corrector_params">
<span class="sig-prename descclassname"><span class="pre">scifysim.correctors.</span></span><span class="sig-name descname"><span class="pre">extract_corrector_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corrector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.extract_corrector_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to reconstruct the <em>b</em> and <em>c</em>
vectors from the lmfit Parameters object.</p>
<p>corrector : The corrector object
params   :  at lmfit Parameters object</p>
<blockquote>
<div><p>containing b_i and c_i terms</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.correctors.get_Is">
<span class="sig-prename descclassname"><span class="pre">scifysim.correctors.</span></span><span class="sig-name descname"><span class="pre">get_Is</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combiner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.get_Is" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns intensities at the combiners’ outputs
taking into account the corrections provided in
params.</p>
<p><strong>dcomp is computed automatically be default.</strong></p>
<dl class="simple">
<dt>params<span class="classifier">either</span></dt><dd><ul class="simple">
<li><p>A Parameters object from the optimization</p></li>
<li><p>A tuple of vectors bvec, cvec</p></li>
</ul>
</dd>
</dl>
<p>combiner : A combiner object.
corrector : The corrector object
lambs    : The wavelengths considered.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.correctors.get_contrast_res">
<span class="sig-prename descclassname"><span class="pre">scifysim.correctors.</span></span><span class="sig-name descname"><span class="pre">get_contrast_res</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combiner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.get_contrast_res" title="Permalink to this definition">¶</a></dt>
<dd><p>Macro that gets the a residual from parameters 
for minimizing method.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.correctors.get_depth">
<span class="sig-prename descclassname"><span class="pre">scifysim.correctors.</span></span><span class="sig-name descname"><span class="pre">get_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">combiner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Is</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.get_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a “null depth” analogue (dark/bright)
to be minimized by the tuning method.
The masks in the combiner definition
are used to determine the role of the different outputs.</p>
<p>combiner : A combiner object.
Is       : An array of intensities</p>
<p>Note: This definition might need some adjustments for
use in kernel-nullers?</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.correctors.get_es">
<span class="sig-prename descclassname"><span class="pre">scifysim.correctors.</span></span><span class="sig-name descname"><span class="pre">get_es</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combiner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.get_es" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the enantiomorph excursion taking into account the corrections provided in
params.
<strong>Currently works only for double-bracewell 3-4 architecures</strong></p>
<p><strong>dcomp is computed automatically be default.</strong></p>
<dl class="simple">
<dt>params<span class="classifier">either</span></dt><dd><ul class="simple">
<li><p>A Parameters object from the optimization</p></li>
<li><p>A tuple of vectors bvec, cvec</p></li>
</ul>
</dd>
</dl>
<p>combiner : A combiner object.
corrector : The corrector object
lambs    : The wavelengths considered.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.correctors.get_shape_res">
<span class="sig-prename descclassname"><span class="pre">scifysim.correctors.</span></span><span class="sig-name descname"><span class="pre">get_shape_res</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combiner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.correctors.get_shape_res" title="Permalink to this definition">¶</a></dt>
<dd><p>Macro that gets the a residual from parameters 
for minimizing method.</p>
</dd></dl>

</section>
<section id="module-scifysim.director">
<span id="scifysim-director-module"></span><h2>scifysim.director module<a class="headerlink" href="#module-scifysim.director" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="scifysim.director.simulator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.director.</span></span><span class="sig-name descname"><span class="pre">simulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.build_all_maps">
<span class="sig-name descname"><span class="pre">build_all_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">mapres=100</span></em>, <em class="sig-param"><span class="pre">mapcrop=1.0</span></em>, <em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.build_all_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the transmission maps for the combiner for all the pointings
on self.target at the times of self.sequence
mapres        : The resolution of the map in pixels
mapcrop       : Adjusts the extent of the map
Returns (also stored in self.map) a transmission map of shape:
[n_sequence,
n_wl_chanels,
n_outputs,
mapres,
mapres]</p>
<p>To get final flux of a point source :
Map/ds_sr * p.ss * DIT
ds_sr can be found in director.vigneting_map</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.build_all_maps_dask">
<span class="sig-name descname"><span class="pre">build_all_maps_dask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapcrop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dask'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.build_all_maps_dask" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the transmission maps for the combiner for all the pointings
on self.target at the times of self.sequence.
Returns an uncomputed dask array referencing one input map per pointing
that are each stored to disk.
call self.maps[element indices].compute() to compute specific elements
without computing the whole map.</p>
<p>mapres        : The resolution of the map in pixels
mapcrop       : Adjusts the extent of the map
Returns (also stored in self.map) a transmission map of shape:
[n_sequence,
n_wl_chanels,
n_outputs,
mapres,
mapres]</p>
<p>To get final flux of a point source :
Map/ds_sr * p.ss * DIT
ds_sr is the scene surface element in steradian
and can be found in director.vigneting_map</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.combine">
<span class="sig-name descname"><span class="pre">combine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inst_phasor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_phasor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.combine" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the output INTENSITY based on the input AMPLITUDE
inst_phasor   : The instrumental phasor to apply to the inputs</p>
<blockquote>
<div><p>dimension (n_wl, n_input)</p>
</div></blockquote>
<dl class="simple">
<dt>geom_phasor<span class="classifier">The geometric phasor due to source location</span></dt><dd><p>dimension (n_wl, n_input)</p>
</dd>
<dt>amplitude<span class="classifier">Complex amplitude of the spectrum of the source</span></dt><dd><p>dimension (n_wl, n_src)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.combine_32">
<span class="sig-name descname"><span class="pre">combine_32</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inst_phasor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_phasor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.combine_32" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the output INTENSITY based on the input AMPLITUDE
This version provides a result in np.float32 format for smaller
memory footprint (for maps)
inst_phasor   : The instrumental phasor to apply to the inputs</p>
<blockquote>
<div><p>dimension (n_wl, n_input)</p>
</div></blockquote>
<dl class="simple">
<dt>geom_phasor<span class="classifier">The geometric phasor due to source location</span></dt><dd><p>dimension (n_wl, n_input)</p>
</dd>
<dt>amplitude<span class="classifier">Complex amplitude of the spectrum of the source</span></dt><dd><p>dimension (n_wl, n_src)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.combine_light">
<span class="sig-name descname"><span class="pre">combine_light</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">asource</span></em>, <em class="sig-param"><span class="pre">injected</span></em>, <em class="sig-param"><span class="pre">input_array</span></em>, <em class="sig-param"><span class="pre">collected</span></em>, <em class="sig-param"><span class="pre">dosum=True</span></em>, <em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.combine_light" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the combination for a discretized light source object 
for all the wavelengths of interest.
Returns the intensity in all outputs at all wavelengths.
inputs:
asource     : Source object or transmission_emission object</p>
<blockquote>
<div><p>including ss and xx_r attributes</p>
</div></blockquote>
<p>injected    : complex phasor for the instrumental errors
input_arra  : The projected geometric configuration of the array</p>
<blockquote>
<div><p>use observatory.get_projected_array()</p>
</div></blockquote>
<p>collected   : The intensity across wavelength and the difference source origins
dtype       : The data type to use (use np.float32 for maps)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.combine_light_dask">
<span class="sig-name descname"><span class="pre">combine_light_dask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asource</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dosum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.combine_light_dask" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the combination for a discretized light source object 
for all the wavelengths of interest. The computation is done 
out of core using dask.
Returns the intensity in all outputs at all wavelengths.
inputs:
asource     : Source object or transmission_emission object</p>
<blockquote>
<div><p>including ss and xx_r attributes as dask arrays</p>
</div></blockquote>
<p>injected    : complex phasor for the instrumental errors
input_array  : The projected geometric configuration of the array</p>
<blockquote>
<div><p>use observatory.get_projected_array()</p>
</div></blockquote>
<dl class="simple">
<dt>collected<span class="classifier">Dask version of the intensity across wavelength</span></dt><dd><p>and the difference source origins</p>
</dd>
<dt>map_index<span class="classifier">The index of the pointing in the sequence. Mostly use for numbering</span></dt><dd><p>of the temporary disk file</p>
</dd>
</dl>
<p># Note that in “dask” mode the <cite>collected</cite> and <cite>source.ss</cite> are expected as dask arrays
#</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.geometric_phasor">
<span class="sig-name descname"><span class="pre">geometric_phasor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.geometric_phasor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the complex phasor corresponding to the locations
of the family of sources
alpha         : The coordinate matched to X in the array geometry
beta          : The coordinate matched to Y in the array geometry
anarray       : The array geometry (n_input, 2)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.geometric_phasor_dask">
<span class="sig-name descname"><span class="pre">geometric_phasor_dask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.geometric_phasor_dask" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the complex phasor corresponding to the locations
of the family of sources
alpha         : The coordinate matched to X in the array geometry</p>
<blockquote>
<div><p>as a dask array (field positions)</p>
</div></blockquote>
<dl class="simple">
<dt>beta<span class="classifier">The coordinate matched to Y in the array geometry</span></dt><dd><p>as a dask array (field positions)</p>
</dd>
</dl>
<p>anarray       : The array geometry (n_input, 2)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.make_exposure">
<span class="sig-name descname"><span class="pre">make_exposure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">interest</span></em>, <em class="sig-param"><span class="pre">star</span></em>, <em class="sig-param"><span class="pre">diffuse</span></em>, <em class="sig-param"><span class="pre">texp=1.0</span></em>, <em class="sig-param"><span class="pre">t_co=0.002</span></em>, <em class="sig-param"><span class="pre">time=None</span></em>, <em class="sig-param"><span class="pre">monitor_phase=True</span></em>, <em class="sig-param"><span class="pre">use_tqdm=False</span></em>, <em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></em>, <em class="sig-param"><span class="pre">spectro=None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.make_exposure" title="Permalink to this definition">¶</a></dt>
<dd><p>Warning: at the moment, this assumes pointing has already been performed.</p>
<p>Simulate an exposure with source of interest and sources of noise
interest  : sf.sources.resolved_source object representing the source of intereest (planet)
star      : sf.sources.resolved_source object representing the star
diffuse   : a list of sf.transmission_emission objects linked in a chain.
texp      : Exposure time (seconds)
t_co      : Coherence time (seconds) 
monitor_phase : If true, will also record values of phase errors from injection and</p>
<blockquote>
<div><p>fringe tracking</p>
</div></blockquote>
<p>dtype     : Data type to use for results
spectro   : spectrograph object to use. If None, the method will assume one pixel</p>
<blockquote>
<div><p>per output and per spectral channel</p>
</div></blockquote>
<p>Chained diffuse objects are used both for transmission and thermal background. 
Result is returned as an integrator object. Currently the integrator object is only a
vessel for the individual subexposures, and not used to do the integration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.make_map">
<span class="sig-name descname"><span class="pre">make_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">blockindex</span></em>, <em class="sig-param"><span class="pre">vigneting_map</span></em>, <em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.make_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Create sensitivity map in ph/s/sr per spectral channel.
To get final flux of a point source :
Map/ds_sr * p.ss * DIT
blockindex : The index in the observing sequence to create the map
vigneting_map : The vigneting map drawn used for resolution</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.make_map_dask">
<span class="sig-name descname"><span class="pre">make_map_dask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blockindex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vigneting_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dask'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.make_map_dask" title="Permalink to this definition">¶</a></dt>
<dd><p>Create sensitivity map in ph/s/sr per spectral channel.
To get final flux of a point source :
Map/ds_sr * p.ss * DIT
blockindex : The index in the observing sequence to create the map
vigneting_map : The vigneting map drawn used for resolution</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.make_metrologic_exposure">
<span class="sig-name descname"><span class="pre">make_metrologic_exposure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">interest</span></em>, <em class="sig-param"><span class="pre">star</span></em>, <em class="sig-param"><span class="pre">diffuse</span></em>, <em class="sig-param"><span class="pre">texp=1.0</span></em>, <em class="sig-param"><span class="pre">t_co=0.002</span></em>, <em class="sig-param"><span class="pre">time=None</span></em>, <em class="sig-param"><span class="pre">monitor_phase=True</span></em>, <em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></em>, <em class="sig-param"><span class="pre">perfect=False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.make_metrologic_exposure" title="Permalink to this definition">¶</a></dt>
<dd><p>Warning: at the moment, this assumes pointing has already been performed.</p>
<p>Simulate an exposure with source of interest and sources of noise
interest  : sf.sources.resolved_source object representing the source of intereest (planet)
star      : sf.sources.resolved_source object representing the star
diffuse   : a list of sf.transmission_emission objects linked in a chain.
texp      : Exposure time (seconds)
t_co      : Coherence time (seconds) 
monitor_phase : If true, will also record values of phase errors from injection and fringe tracking</p>
<p>Chained diffuse objects are used both for transmission and thermal background. 
Result is returned as an integrator object. Currently the integrator object is only a
vessel for the individual subexposures, and not used to do the integration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.make_sequence">
<span class="sig-name descname"><span class="pre">make_sequence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.make_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an observing sequence</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.persist_maps_to_disk">
<span class="sig-name descname"><span class="pre">persist_maps_to_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/tmp/full_maps.zarr'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.persist_maps_to_disk" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes and stores the map to disk. The file is then loaded
out of core and is still accessible in the same way (but without
the computing times).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.point">
<span class="sig-name descname"><span class="pre">point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.point" title="Permalink to this definition">¶</a></dt>
<dd><p>Points the array towards the target. Updates the 
time    : The time to make the observation
target  : The skycoord object to point</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.prepare_combiner">
<span class="sig-name descname"><span class="pre">prepare_combiner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.prepare_combiner" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs self.combiner</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.prepare_corrector">
<span class="sig-name descname"><span class="pre">prepare_corrector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.prepare_corrector" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the corrector object for the simulator, based
on a config file.</p>
<dl class="simple">
<dt>config<span class="classifier">Either:</span></dt><dd><ul class="simple">
<li><p>None (default) to use the simulators config</p></li>
<li><p>A parsed config file</p></li>
</ul>
</dd>
</dl>
<p>optimize : Boolean. If True, will optimize both depth and shape
apply    : Boolean. If True, apply the optimization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.prepare_fringe_tracker">
<span class="sig-name descname"><span class="pre">prepare_fringe_tracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.prepare_fringe_tracker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.prepare_injector">
<span class="sig-name descname"><span class="pre">prepare_injector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntelescopes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_piston</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_hrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.prepare_injector" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Either: </dt><dd><ul class="simple">
<li><p>Provide all parameters</p></li>
<li><p>Provide a config file</p></li>
<li><p>provide the injector</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.prepare_integrator">
<span class="sig-name descname"><span class="pre">prepare_integrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infinite_well</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.prepare_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the integraro object that rules the pixel properties
of the detector.
config    : A parsed config file (default: None will reuse the config file in self.)
keepall   : [boolean] Whether to keep each of the steps accumulated.</p>
<blockquote>
<div><p>False is recommended for faster computation and memory efficiency</p>
</div></blockquote>
<dl class="simple">
<dt>n_sources<span class="classifier">Number of sources sequencially accumulated. (deprecated, do not</span></dt><dd><p>rely on this number)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.prepare_observatory">
<span class="sig-name descname"><span class="pre">prepare_observatory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.prepare_observatory" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprare the observatory object for the simulator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.prepare_sequence">
<span class="sig-name descname"><span class="pre">prepare_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_daytime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.prepare_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare an observing sequence</p>
<dl class="simple">
<dt>coordinates<span class="classifier">read from file by default</span></dt><dd><p>if skycoord object provided, then use that.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.prepare_sources">
<span class="sig-name descname"><span class="pre">prepare_sources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.prepare_sources" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares a src object containing star, planet, sky and UT.
file     : A parsed config file (default: None will reuse the config file in self.)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.prepare_spectrograph">
<span class="sig-name descname"><span class="pre">prepare_spectrograph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_chan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.prepare_spectrograph" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the spectrograph object that maps the light over the detector.
file     : A parsed config file (default: None will reuse the config file in self.)
n_chan   : The number of outputs from the chip. If None: tries to get it from</p>
<blockquote>
<div><p>the shape of self.combiner.M</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.director.simulator.reset_static">
<span class="sig-name descname"><span class="pre">reset_static</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.simulator.reset_static" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.director.test_director">
<span class="sig-prename descclassname"><span class="pre">scifysim.director.</span></span><span class="sig-name descname"><span class="pre">test_director</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.director.test_director" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="scifysim-dummy-module">
<h2>scifysim.dummy module<a class="headerlink" href="#scifysim-dummy-module" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-scifysim.injection">
<span id="scifysim-injection-module"></span><h2>scifysim.injection module<a class="headerlink" href="#module-scifysim.injection" title="Permalink to this headline">¶</a></h2>
<p>This module revolves around the injector class
At __init__(), injector builds
* one atmo object for each telescope (stored in a list)
* one focuser object (badly named) for each wavelength AND each telescope
* one fiber_head object that builds the map of LP01 mode.
It then creates a generator called <cite>self.it</cite> that will return
a series of complex numbers corresponding to injection complex phasors.</p>
<p>Testing:
test_fiber for the <cite>fiber_head</cite>
test_injector for the <cite>injector</cite></p>
<dl class="py function">
<dt class="sig sig-object py" id="scifysim.injection.Hn">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">Hn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.Hn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scifysim.injection.J0">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">J0</span></span><a class="headerlink" href="#scifysim.injection.J0" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">None.J_0</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scifysim.injection.J1">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">J1</span></span><a class="headerlink" href="#scifysim.injection.J1" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">None.J_1</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="scifysim.injection.K0">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">K0</span></span><a class="headerlink" href="#scifysim.injection.K0" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">None.K_0</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.injection.atmo">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">atmo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GRAVITY+'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ro_wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_speed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_excess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdiam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.atmo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Atmospheric Kolmogorov-type phase screen.</p>
<ul class="simple">
<li><p>csz     : size (csz x csz) of the phase screen       (in pixels)</p></li>
<li><p>pdiam   : diameter of the aperture within this array (in pixels)</p></li>
<li><p>rndarr  : uniformly distributed random array         (csz x csz)</p></li>
<li><p>kolm    : the original phase screen                  (csz x csz)</p></li>
<li><p>kolm2   : the oversized phase screen    ((csz + pdiam) x (csz + pdiam))</p></li>
<li><p>qstatic : an optional quasi static aberration    (pdiam x pdiam)</p></li>
<li><p>rms     : total phase screen rms value           (in nanometers)</p></li>
<li><p>rms_i   : instant rms inside the pupil           (in nanometers)</p></li>
</ul>
<p>While the attributes are documented here for reference, the prefered
way of interacting with them is via the functions defined within the
class.
====================================================================</p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.atmo.give">
<span class="sig-name descname"><span class="pre">give</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.atmo.give" title="Permalink to this definition">¶</a></dt>
<dd><p>Main loop: frozen screen slid over the aperture</p>
<p>This returns a iterator that yelds the phase screen
for one aperture.</p>
<dl class="simple">
<dt>use: a = atmo.give()</dt><dd><p>phscreen = next(a)
phscreen = next(a)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.atmo.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.atmo.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.atmo.set_qstatic">
<span class="sig-name descname"><span class="pre">set_qstatic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qstatic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.atmo.set_qstatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines some quasistatic errors in the wavefront
qstatic    : A static phase screen</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.atmo.update_screen">
<span class="sig-name descname"><span class="pre">update_screen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">correc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.atmo.update_screen" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic update of the properties of the phase-screen
correc   : The correction factor for the control region
fc       : The 
r0       : r0 of the initial phase screen
————————————————</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.atmo.update_step_vector">
<span class="sig-name descname"><span class="pre">update_step_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wind_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_speed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.atmo.update_step_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Refresh the step vector that will be applied
wind_angle : the angle of incience of the wind (values around 0.1 rad</p>
<blockquote>
<div><p>are favoured since they provide long series before repeating)</p>
</div></blockquote>
<p>wind_speed : The speed of the moving phase screen.
step_time  : The time step of the simulation [s]</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.injection.atmo_screen">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">atmo_screen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">screen_dimension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_excess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdiam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.atmo_screen" title="Permalink to this definition">¶</a></dt>
<dd><p>The Kolmogorov - Von Karman phase screen generation algorithm.</p>
<p>Adapted from the work of Carbillet &amp; Riccardi (2010).
<a class="reference external" href="http://cdsads.u-strasbg.fr/abs/2010ApOpt..49G..47C">http://cdsads.u-strasbg.fr/abs/2010ApOpt..49G..47C</a></p>
<p>Kolmogorov screen can be altered by an attenuation of the power
by a correction factor <em>correc</em> up to a cut-off frequency <em>fc</em>
expressed in number of cycles across the phase screen</p>
<ul class="simple">
<li><p>screen_dimension    : the size of the array to be computed (in pixels)</p></li>
<li><p>screen_extent     :  the physical extent of the phase screen (in meters)</p></li>
<li><p>r0     : the Fried parameter, measured at a given wavelength (in meters)</p></li>
<li><p>L0     : the outer scale parameter (in meters)</p></li>
<li><p>fc     : DM cutoff frequency (in lambda/D)</p></li>
<li><p>correc : correction of wavefront amplitude (factor 10, 100, …)</p></li>
<li><dl class="simple">
<dt>lo_excess: A factor introducing excess low-order averations (mosly tip-tilt)</dt><dd><p>Must be striclty 0 =&lt; lo_excess &lt; 1.</p>
</dd>
</dl>
</li>
<li><p>pdiam  : pupil diameter (in meters)</p></li>
<li><p>seed   : random seed for the screen (default: None produces a new seed)</p></li>
</ul>
<p>Returns: two independent phase screens, available in the real and 
imaginary part of the returned array.</p>
<p>If pdiam is not specified, the code assumes that the diameter of
the pupil is equal to the extent of the phase screen “screen_extent”.
———————————————————–</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.injection.fiber_head">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">fiber_head</span></span><a class="headerlink" href="#scifysim.injection.fiber_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fiber_head.build_equation">
<span class="sig-name descname"><span class="pre">build_equation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fiber_head.build_equation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fiber_head.consolidate_equation">
<span class="sig-name descname"><span class="pre">consolidate_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thesubs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fiber_head.consolidate_equation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fiber_head.define_substitutions">
<span class="sig-name descname"><span class="pre">define_substitutions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fiber_head.define_substitutions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fiber_head.full_consolidation">
<span class="sig-name descname"><span class="pre">full_consolidation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fiber_head.full_consolidation" title="Permalink to this definition">¶</a></dt>
<dd><p>Completes the consolidation of the lambda function
with the application parameters:
NA  : The numerical aperture
a   : The core radius in meters
ncore : the refractive index of the core</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fiber_head.numerical_evaluation">
<span class="sig-name descname"><span class="pre">numerical_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">half_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fiber_head.numerical_evaluation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.injection.focuser">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">focuser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SCExAO_chuck'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ysz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xsz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pupil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rm_inj_piston</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdiam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.92</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.6e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.focuser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generic monochoromatic camera class</p>
<p>The camera is connected to the other objects (DM- and atmosphere- induced
wavefronts) via shared memory data structures, after instantiation of
the camera, when it is time to take an image.</p>
<p>I am also considering another class to xaosim to describe the astrophysical
scene and the possibility to simulate rather simply images of complex
objects.</p>
<p>Using a generic convolutive approach would work all the time, but may be
overkill for 90% of the use cases of this piece of software so I am not
sure yet.
===========================================================================</p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.focuser.get_injection">
<span class="sig-name descname"><span class="pre">get_injection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phscreen</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.focuser.get_injection" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the complex injection phasor based on fiber mode in the pupil plane.</p>
<ul class="simple">
<li><p>phscreen:    The piston map in µm</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.focuser.get_inv_image">
<span class="sig-name descname"><span class="pre">get_inv_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.focuser.get_inv_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.focuser.get_tilt">
<span class="sig-name descname"><span class="pre">get_tilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phscreen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.focuser.get_tilt" title="Permalink to this definition">¶</a></dt>
<dd><p>Measures the tip-tilt measurement corresponding to the wavefront
provided. The tip-tilt is in a 2-array and the unit is lambda/D 
where D is the extent of the pupil mask.
——————————————————————-</p>
<ul class="simple">
<li><p>phscreen:   The piston map in µm</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.focuser.getimage">
<span class="sig-name descname"><span class="pre">getimage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phscreen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.focuser.getimage" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces an image, given a certain number of phase screens,
and updates the shared memory data structure that the camera
instance is linked to with that image</p>
<p>If you need something that returns the image, you have to use the
class member method get_image(), after having called this method.
——————————————————————-</p>
<ul class="simple">
<li><p>phscreen:   The piston map in µm</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.focuser.sft">
<span class="sig-name descname"><span class="pre">sft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.focuser.sft" title="Permalink to this definition">¶</a></dt>
<dd><p>Class specific implementation of the explicit Fourier Transform</p>
<p>The algorithm is identical to the function in the sft module,
except that intermediate FT arrays are stored for faster
computation.</p>
<p>For a more generic implementation, refer to the sft module of this
package.</p>
<p>Assumes the original array is square.
No need to “center” the data on the origin.
————————————————————–</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.focuser.update_cam">
<span class="sig-name descname"><span class="pre">update_cam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">between_pixel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.focuser.update_cam" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the filter, the plate scale or the centering of the camera</p>
<p>Parameters:
- pscale        : the plate scale of the image, in mas/pixel
- wl            : the central wavelength of observation, in meters
- between_pixel : whether FT are centered between four pixels or not
——————————————————————-</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.focuser.update_signal">
<span class="sig-name descname"><span class="pre">update_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.focuser.update_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the strength of the signal</p>
<p>Automatically sets the <em>phot_noise</em> flag to <em>True</em>
<em>IF</em> the value provided is negative, it sets the <em>phot_noise</em> flag
back to <em>False</em> and sets the signal back to 1e6 photons</p>
<ul class="simple">
<li><p>nph: the total number of photons inside the frame</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.injection.fringe_tracker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">fringe_tracker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theconfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fringe_tracker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fringe_tracker.get_phasor_dry">
<span class="sig-name descname"><span class="pre">get_phasor_dry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fringe_tracker.get_phasor_dry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fringe_tracker.get_phasor_precomputed_dry">
<span class="sig-name descname"><span class="pre">get_phasor_precomputed_dry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fringe_tracker.get_phasor_precomputed_dry" title="Permalink to this definition">¶</a></dt>
<dd><p>Precomputed computation are recommended for longer time series when trying to factor-in long timescale effects.
One can prepare the “low” resolution series, and dump the original dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fringe_tracker.interpolate_batch">
<span class="sig-name descname"><span class="pre">interpolate_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fringe_tracker.interpolate_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>optional:
Prepares lookup tables for direct lookup of piston values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fringe_tracker.iterator">
<span class="sig-name descname"><span class="pre">iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lamb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fringe_tracker.iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator that yields the phasors of fringe tracker residuals
The iterator sets for precomputed or direct interpolation depending on the configuration.
It also sets for wet or dry computation depending on the configuration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fringe_tracker.prepare_interpolation">
<span class="sig-name descname"><span class="pre">prepare_interpolation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fringe_tracker.prepare_interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Mandatory
Computes the interpolation functions to be used later
save:
self.piston_interpolation()
self.dispersion_interpolation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.fringe_tracker.prepare_time_series">
<span class="sig-name descname"><span class="pre">prepare_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lamb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.fringe_tracker.prepare_time_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Call to refresh the time series to use
duration        : The duration of the time series to prepare
replace         : Replace the time series (otherwise append)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.injection.gaussian_fiber_head">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">gaussian_fiber_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl_mfd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.gaussian_fiber_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.gaussian_fiber_head.build_equation">
<span class="sig-name descname"><span class="pre">build_equation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.gaussian_fiber_head.build_equation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.gaussian_fiber_head.consolidate_equation">
<span class="sig-name descname"><span class="pre">consolidate_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thesubs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.gaussian_fiber_head.consolidate_equation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.gaussian_fiber_head.define_substitutions">
<span class="sig-name descname"><span class="pre">define_substitutions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.gaussian_fiber_head.define_substitutions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.gaussian_fiber_head.full_consolidation">
<span class="sig-name descname"><span class="pre">full_consolidation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mfd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl_mfd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.gaussian_fiber_head.full_consolidation" title="Permalink to this definition">¶</a></dt>
<dd><p>Completes the consolidation of the lambda function
with the application parameters:</p>
<p>NA      : The numerical aperture
mfd     : The mode field diameter in [m]
wl_mfd  : The wavelength at which mfd is measured in [m]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.gaussian_fiber_head.numerical_evaluation">
<span class="sig-name descname"><span class="pre">numerical_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">half_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.gaussian_fiber_head.numerical_evaluation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.injection.injection_vigneting">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">injection_vigneting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">injector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injection_vigneting" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A shortcut to injection simulation in the case of diffuse sources
injector     : an injector object to emulate
res          :</p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injection_vigneting.vigneted_spectrum">
<span class="sig-name descname"><span class="pre">vigneted_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exptime</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injection_vigneting.vigneted_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>spectrum   : Flux density in ph/s/sr/m^2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.injection.injector">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">injector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pupil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'VLT'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdiam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odiam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntelescopes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_piston</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.25e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_hrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rm_inj_piston</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atmo_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.all_inj_phasors">
<span class="sig-name descname"><span class="pre">all_inj_phasors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambdas</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.all_inj_phasors" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that applies interpolation for all the inputs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.best_injection">
<span class="sig-name descname"><span class="pre">best_injection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambdas</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.best_injection" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function that applies interpolation for all the inputs</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.compute_best_injection">
<span class="sig-name descname"><span class="pre">compute_best_injection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interpolation</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.compute_best_injection" title="Permalink to this definition">¶</a></dt>
<dd><p>This one will yield the method that interpolates all the injection phasors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.compute_injection_function">
<span class="sig-name descname"><span class="pre">compute_injection_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tilt_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tilt_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.compute_injection_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes an interpolation of the injection as a function of a tip-tilt</p>
<p>injector.injection_abs(wl [m], offset [lambda/D])</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.from_config_file">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">from_config_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focal_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pupil</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.from_config_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the injector object from a config file
file      : A pre-parsed config file
fpath     : The path to a config file
nwl       : The number of wl channels
focal_res : The total resolution of the focal plane to simulate</p>
<p>Gathers the variables from the config file then calls for a class instance (__init__())</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.give_comparison">
<span class="sig-name descname"><span class="pre">give_comparison</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.give_comparison" title="Permalink to this definition">¶</a></dt>
<dd><p>A test comparison between image and pupil plane injection</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.give_fiber">
<span class="sig-name descname"><span class="pre">give_fiber</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.give_fiber" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.give_interpolated">
<span class="sig-name descname"><span class="pre">give_interpolated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interpolation</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.give_interpolated" title="Permalink to this definition">¶</a></dt>
<dd><p>This one will yield the method that interpolates all the injection phasors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.give_interpolated_injection_image_plane">
<span class="sig-name descname"><span class="pre">give_interpolated_injection_image_plane</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interpolation</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.give_interpolated_injection_image_plane" title="Permalink to this definition">¶</a></dt>
<dd><p>This one will yield the method that interpolates all the injection phasors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.reset_screen">
<span class="sig-name descname"><span class="pre">reset_screen</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.reset_screen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.injection.injector.update_screens">
<span class="sig-name descname"><span class="pre">update_screens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.injector.update_screens" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all the screens for the injection</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.injection.optimize_a">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">optimize_a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.optimize_a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.injection.seeing_to_r0">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">seeing_to_r0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seeing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.seeing_to_r0" title="Permalink to this definition">¶</a></dt>
<dd><p>seeing : seeing in arcseconds
wl     : wl in m</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.injection.tel_pupil">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">tel_pupil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdiam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odiam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spiders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">between_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tel_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.tel_pupil" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an array that draws the pupil of the VLT
at the center of an array of size (n,m) with radius “radius”.</p>
<p>This is an approximation to reduce number of parameters:
offset an angle are approximated. See xaosim.pupil.VLT for original</p>
<p>Parameters describing the pupil were deduced from a pupil mask
description of the APLC coronograph of SPHERE, by Guerri et al, 
2011.</p>
<p><a class="reference external" href="http://cdsads.u-strasbg.fr/abs/2011ExA....30...59G">http://cdsads.u-strasbg.fr/abs/2011ExA….30…59G</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.injection.test_fiber">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">test_fiber</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.test_fiber" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.injection.test_injection">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">test_injection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phscreensz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20127</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.test_injection" title="Permalink to this definition">¶</a></dt>
<dd><p>Remember to pass seed=None if you want a random initialization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.injection.test_injection_fromfile">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">test_injection_fromfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phscreensz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/rlaugier/Documents/hi5/SCIFYsim/scifysim/config/default_new_4T.ini'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20127</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.test_injection_fromfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Remember to pass seed=None if you want a random initialization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.injection.test_injection_function">
<span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">test_injection_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.test_injection_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.injection.unsorted_interp2d">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.injection.</span></span><span class="sig-name descname"><span class="pre">unsorted_interp2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.injection.unsorted_interp2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.interpolate.interpolate.interp2d</span></code></p>
</dd></dl>

</section>
<section id="module-scifysim.map_manager">
<span id="scifysim-map-manager-module"></span><h2>scifysim.map_manager module<a class="headerlink" href="#module-scifysim.map_manager" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="scifysim.map_manager.map_meta">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.map_manager.</span></span><span class="sig-name descname"><span class="pre">map_meta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starmags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mgs_TNP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.map_manager.map_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.map_manager.map_meta.from_fits">
<span class="sig-name descname"><span class="pre">from_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.map_manager.map_meta.from_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads meta map from file</p>
<p>file    :  The path to a fits file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.map_manager.map_meta.from_sim">
<span class="sig-name descname"><span class="pre">from_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starmags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.map_manager.map_meta.from_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the meta map from simulator</p>
<p>asim    : Simulator object from which map parameters are taken
starmags : An array of star magnitudes
mgs     : The planet magnitude maps</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.map_manager.map_meta.get_loc">
<span class="sig-name descname"><span class="pre">get_loc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.map_manager.map_meta.get_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the index location from a relative location and star magnitude. Returns 
a tuple index to query self.mgs</p>
<p>loc      : 2-tuple Relative location on sky in the band of interest
mag      : Magnitude of the host star</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.map_manager.map_meta.get_value">
<span class="sig-name descname"><span class="pre">get_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'E'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.map_manager.map_meta.get_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the limiting magnitude for a planet at the relative location <strong>loc</strong>
around a star of magnitude <strong>mag</strong>.</p>
<p>loc      : 2-tuple Relative location on sky in the band of interest
mag      : Magnitude of the host star 
detector   : The type of detector test: “E” for energy detector</p>
<blockquote>
<div><p>“N” for Neyman-Pearson</p>
</div></blockquote>
<p>pmag_limit = mymap.get_value((5.2, 4.8), 4.)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.map_manager.map_meta.plot_map">
<span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'E'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.map_manager.map_meta.plot_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses matplotlib to show a map at a given star magnitude.</p>
<p>mag      : The star magnitude
cmap       : The colormap to use
detector   : The type of detector test: “E” for energy detector</p>
<blockquote>
<div><p>“N” for Neyman-Pearson</p>
</div></blockquote>
<p><a href="#id7"><span class="problematic" id="id8">**</span></a>kwargs : Keyword arguments to pass to plt.figure()
Returns the figure object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.map_manager.map_meta.to_fits">
<span class="sig-name descname"><span class="pre">to_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.map_manager.map_meta.to_fits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-scifysim.mol_dens">
<span id="scifysim-mol-dens-module"></span><h2>scifysim.mol_dens module<a class="headerlink" href="#module-scifysim.mol_dens" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scifysim.mol_dens.mol_dens">
<span class="sig-prename descclassname"><span class="pre">scifysim.mol_dens.</span></span><span class="sig-name descname"><span class="pre">mol_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pres</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">co2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph2o</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wvdens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.mol_dens.mol_dens" title="Permalink to this definition">¶</a></dt>
<dd><p>; PURPOSE:
;   Returns the molair density of air and watervapor as a function temperature (in K), pressure (in mbar), relative humidity (%) and CO2 content (in ppm).
;
; REFERENCE:
;   P.E. Ciddor, “The refractive index of air: new equations for the visible and near infrared”, Appl. Opt. 35 (9), 1566-1573
;
; MODIFICATION HISTORY:
;   Version 1.0, 09-OCT-2002, by Roland den Hartog, ESA / ESTEC /  Genie team, <a class="reference external" href="mailto:rdhartog&#37;&#52;&#48;rssd&#46;esa&#46;int">rdhartog<span>&#64;</span>rssd<span>&#46;</span>esa<span>&#46;</span>int</a></p>
<p># !RL ???? :
ON_ERROR,2
ptot=pres*100.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.mol_dens.set_logging_level">
<span class="sig-prename descclassname"><span class="pre">scifysim.mol_dens.</span></span><span class="sig-name descname"><span class="pre">set_logging_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.mol_dens.set_logging_level" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.mol_dens.test_mol">
<span class="sig-prename descclassname"><span class="pre">scifysim.mol_dens.</span></span><span class="sig-name descname"><span class="pre">test_mol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.mol_dens.test_mol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-scifysim.n_air">
<span id="scifysim-n-air-module"></span><h2>scifysim.n_air module<a class="headerlink" href="#module-scifysim.n_air" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scifysim.n_air.m2thz">
<span class="sig-prename descclassname"><span class="pre">scifysim.n_air.</span></span><span class="sig-name descname"><span class="pre">m2thz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.n_air.m2thz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.n_air.n_air">
<span class="sig-prename descclassname"><span class="pre">scifysim.n_air.</span></span><span class="sig-name descname"><span class="pre">n_air</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">288.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">co2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">450.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph2o</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.n_air.n_air" title="Permalink to this definition">¶</a></dt>
<dd><p>; DESCRIPTION
;   Returns the phase refractive index (n-1) of air a function of (IR) wavelength (in m),
;   and optionally, temperature (in K), pressure (in bar), relative humidity (%) and CO2 content (in ppm).
;   Note that the used approximation for air applies in the range from 300 to 1690 nm,
;   hence their use at much longer wavelengths should be done with caution.
;   For wavelengths longer than 1.7 micron, use the Hill &amp; Lawrence approximation for water vapor,
;   which has been verified with experimental data up to 15 micron.
;
; INPUT
;   <a href="#id11"><span class="problematic" id="id12">lambda_</span></a> : wavelength vector in meters
;
; KEYWORDS
;   temp   : air temperature [K]
;   pres   : air pressure [mbar]
;   rhum   : relative humidity of the air [%]
;   co2    : CO2 content in the air [ppm]
;   ph2o   : partial pressure of water vapour [in Pa = 0.01 mbar]
;            if set, overrules RHUM – if not defined, partial pressure will be given on output
;   eso    : set this keyword to use E. Marchetti’s moist air refractive index instead of Ciddor + Hill &amp; Lawrance
;   column : set this keyword to convert to input into fs/(mopl/m²), instead of the standard unitless n-1 value
;   nws    : on output, returns the refractive index of pure water vapour (unless ESO keyword is set)
;
; CALLS
;   MOL_DENS
;   N_H2O
;
; REFERENCE
;   J.E. Decker et al. “Updates to the NRC gauge block interferometer”, NRC document 42753, 8 August 2000
;   P.E. Ciddor, “The refractive index of air: new equations for the visible and near infrared”, Appl. Opt. 35 (9), 1566-1573
;   J. Meisner &amp; R. Le Poole, “Dispersion affecting the VLTI and 10 micron interferometry using MIDI”, Proc. SPIE 4838
;   <a class="reference external" href="http://www.eso.org/gen-fac/pubs/astclim/lasilla/diffrefr.html">http://www.eso.org/gen-fac/pubs/astclim/lasilla/diffrefr.html</a>
;
; MODIFICATION HISTORY
;   Version 1.0, 17-SEP-2002, by Roland den Hartog, ESA / ESTEC /  Genie team, <a class="reference external" href="mailto:rdhartog&#37;&#52;&#48;rssd&#46;esa&#46;int">rdhartog<span>&#64;</span>rssd<span>&#46;</span>esa<span>&#46;</span>int</a>
;   Version 1.1, 09-OCT-2002, RdH: conversion to column densities (Meisner’s n^hat) implemented
;   Version 1.2, 01-NOV-2002, RdH: water vapor index based on approximation also valid in the IR
;   Version 1.3, 03-JUL-2003, OA:  PostScript output of test harness modified
;   Version 1.4, 15-DEC-2009, OA:  Removed discontinuity at 1.7µm by using tabulated water vapour refraction index instead of models + improved header</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.n_air.n_h2o">
<span class="sig-prename descclassname"><span class="pre">scifysim.n_air.</span></span><span class="sig-name descname"><span class="pre">n_h2o</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">co2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">450.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1013.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">296.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.n_air.n_h2o" title="Permalink to this definition">¶</a></dt>
<dd><p>; PURPOSE:
;   Returns the refractive index (n-1) of water vapor a function of (IR) wavelength (in m),
;   in the range from 3.3 to 10.6 micron,
;   and optionally, temperature (in K), and vapor density in (kg/m3)
;
; KEYWORDS:
;   TEMP:   temperature in K
;   PRES:   pressure in mbar
;   RHUM:   relative humidity in %
;   CO2:    CO2 fraction in ppm
;   APPROX: if not set, the table from Mathar will be interpolated at the input wavelengths
;           if set to 1, use approximate formula by Hill &amp; Lawrence
;           if set to 2, use approximate formula by Ciddor
;   TABLE:  set this keyword to use the full Mathar table – warning, this modifies the lambda array on output (ONLY FOR TEST PURPOSE)
;   COLUMN: convert units to fs / (mol/m�), such that t_delay = n_H20 * column density
;   RAD:    convert units to radians
;   WDA:    the refraction index is given for water vapour displacing air instead of bare water vapour, in units of fs/(mol/m�)
;
; RESTRICTIONS:
;   Does require a file ‘n_mathar.dat’ to be present in same directory
;   The Mathar data table does not include wavelengths smaller than 1.819 �m.
;   At wavelengths smaller than 1.819 �m, the Hill &amp; Lawrence approximation is used instead.
;   This produces a discontinuity of N_H2O at 1.819 �m.
;
; CALLS:
;   N_AIR
;
; REFERENCE:
;   R.J. Hill, R.S. Lawrence, “Refractive index of water vapor in infrared windows”, Infrared Phys. 26, 371 - 376 (1986)
;   P.E. Ciddor, “The refractive index of air: new equations for the visible and near infrared”, Appl. Opt. 35 (9), 1566-1573
;   F. Hase, R.J. Mathar, “Water vapor dispersion in the atmospheric window at 10 um”, Preprint, 06-FEB-2002
;
; MODIFICATION HISTORY:
;   Version 1.0, 13-SEP-2002, by Roland den Hartog, ESA / ESTEC /  Genie team, <a class="reference external" href="mailto:rdhartog&#37;&#52;&#48;rssd&#46;esa&#46;int">rdhartog<span>&#64;</span>rssd<span>&#46;</span>esa<span>&#46;</span>int</a>
;   Version 2.0, 09-OCT-2002, RdH: included tabulated data by R.J. Mathar (obtained via J. Meisner)
;   Version 2.1, 29-OCT-2002, RdH: conversion to WDA implemented
;   Version 2.2, 01-NOV-2002, RdH: Ciddor’s approximation implemented
;   Version 2.3, 15-DEC-2009, OA:  Improved header
;
; TESTED
;   13-SEP-2002, RdH: comparison with measurements by Hase and Mathar
;   09-OCT-2002, RdH: direct comparison between Hill &amp; Lawrence’s approximation and Mathar’s data
;   15-NOV-2004, RdH: implemented option to convert output directly into radians</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.n_air.set_logging_level">
<span class="sig-prename descclassname"><span class="pre">scifysim.n_air.</span></span><span class="sig-name descname"><span class="pre">set_logging_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.n_air.set_logging_level" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.n_air.test_air">
<span class="sig-prename descclassname"><span class="pre">scifysim.n_air.</span></span><span class="sig-name descname"><span class="pre">test_air</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.n_air.test_air" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.n_air.test_h2o">
<span class="sig-prename descclassname"><span class="pre">scifysim.n_air.</span></span><span class="sig-name descname"><span class="pre">test_h2o</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.n_air.test_h2o" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.n_air.thz2m">
<span class="sig-prename descclassname"><span class="pre">scifysim.n_air.</span></span><span class="sig-name descname"><span class="pre">thz2m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.n_air.thz2m" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.n_air.wet_atmo">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.n_air.</span></span><span class="sig-name descname"><span class="pre">wet_atmo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.n_air.wet_atmo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.n_air.wet_atmo.get_Nair">
<span class="sig-name descname"><span class="pre">get_Nair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.n_air.wet_atmo.get_Nair" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-scifysim.observatory">
<span id="scifysim-observatory-module"></span><h2>scifysim.observatory module<a class="headerlink" href="#module-scifysim.observatory" title="Permalink to this headline">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="scifysim.observatory.logit">
<span class="sig-prename descclassname"><span class="pre">scifysim.observatory.</span></span><span class="sig-name descname"><span class="pre">logit</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;Logger</span> <span class="pre">scifysim.observatory</span> <span class="pre">(WARNING)&gt;</span></em><a class="headerlink" href="#scifysim.observatory.logit" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic usage:</p>
<p>import kernuller.observatory
myobs = kernuller.observatory.observatory(kernuller.VLTI)
tarnames = “Spica”
targets = [kernuller.observatory.astroplan.FixedTarget.from_name(tar) for tar in tarnames]
obstimes = myobs.build_observing_sequence()
target_positions = myobs.get_positions(targets[0], obstimes)
newarray = myobs.get_projected_array(myobs.get_positions(targets, obstimes)[0,0])</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.observatory.observatory">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.observatory.</span></span><span class="sig-name descname"><span class="pre">observatory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statlocs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_dish</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.observatory.observatory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class help define the properties of the observatory infrastructure, especially the uv coverage.</p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.observatory.observatory.build_observing_sequence">
<span class="sig-name descname"><span class="pre">build_observing_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_daytime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.observatory.observatory.build_observing_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the series of obstimes needed to compute the altaz positions
times : a list of UTC time strings (“2020-04-13T00:00:00”)</p>
<blockquote>
<div><p>that define an interval (if npoints is not None,
or the complete list of times (if npoints is None)</p>
</div></blockquote>
<dl class="simple">
<dt>npoints<span class="classifier">The number of samples to take on the interval</span></dt><dd><p>None means that the times is the whole list</p>
</dd>
</dl>
<p>remove_daytime : Whether to remove the points that fall during the day</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.observatory.observatory.get_position">
<span class="sig-name descname"><span class="pre">get_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_times_targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.observatory.observatory.get_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the astropy.coordinates.AltAz for a given target
target:   one or a list of of targets
obstimes: one or a list of astropy.Times to make the observations</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.observatory.observatory.get_positions">
<span class="sig-name descname"><span class="pre">get_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obstimes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.observatory.observatory.get_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated</p>
<p>Returns the astropy.coordinates.AltAz for a given target
targets: A list of SkyCoord objects 
obstimes: A list of astropy.Times to make the observations</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.observatory.observatory.get_projected_array">
<span class="sig-name descname"><span class="pre">get_projected_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">taraltaz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.observatory.observatory.get_projected_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the new coordinates for the projected array
taraltaz : the astropy.coordinates.AltAz of the target
PA       : parallactic angle to derotate 
loc_array: the array of points to use (None: use self.statlocs)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.observatory.observatory.get_projected_geometric_pistons">
<span class="sig-name descname"><span class="pre">get_projected_geometric_pistons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">taraltaz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.observatory.observatory.get_projected_geometric_pistons" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the geomtric piston resutling from the pointing
of the array.
taraltaz : the astropy.coordinates.AltAz of the target</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.observatory.observatory.point">
<span class="sig-name descname"><span class="pre">point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obstime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.observatory.observatory.point" title="Permalink to this definition">¶</a></dt>
<dd><p>Points the array towards the target, updating its position angle (PA) and altaz (used for airmass).
These are later used by other methods to compute the projection of the array.</p>
<dl class="simple">
<dt>obstime<span class="classifier">The astropy.time.Time object corresponding to the moment of observation</span></dt><dd><p>(usually picked from the sequence provided by self.build_observing_sequence())</p>
</dd>
<dt>target<span class="classifier">The astroplan.FixedTarget object of interest. Usually resolved in the </span></dt><dd><p>self.build_observign_sequence() routine with astroplan.FixedTarget.from_name()</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.observatory.test_observatory">
<span class="sig-prename descclassname"><span class="pre">scifysim.observatory.</span></span><span class="sig-name descname"><span class="pre">test_observatory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tarname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Tau</span> <span class="pre">cet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['2020-10-20T00:00:00',</span> <span class="pre">'2020-10-20T10:00:00']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nblocs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.observatory.test_observatory" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs some test for the core functions of observatory
tarname    : The name of the target to use
startend   : A list or tuple of two time strings inspressed in UTC matching the format:</p>
<blockquote>
<div><p>“2020-10-20T00:00:00”</p>
</div></blockquote>
<p>nblocs     : The number of observing blocs to compute</p>
</dd></dl>

</section>
<section id="module-scifysim.parsefile">
<span id="scifysim-parsefile-module"></span><h2>scifysim.parsefile module<a class="headerlink" href="#module-scifysim.parsefile" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scifysim.parsefile.getarray">
<span class="sig-prename descclassname"><span class="pre">scifysim.parsefile.</span></span><span class="sig-name descname"><span class="pre">getarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">self</span></em>, <em class="sig-param"><span class="pre">section</span></em>, <em class="sig-param"><span class="pre">key</span></em>, <em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.parsefile.getarray" title="Permalink to this definition">¶</a></dt>
<dd><p>An extra get method to parse arrays 
section   : (str) The section to get the data from
key       : (str) The key of the data
dtype     : A data type for the array conversion</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.parsefile.getdate">
<span class="sig-prename descclassname"><span class="pre">scifysim.parsefile.</span></span><span class="sig-name descname"><span class="pre">getdate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.parsefile.getdate" title="Permalink to this definition">¶</a></dt>
<dd><p>An extra get method to parse dates in the GENIE .prm format
section   : (str) The section to get the data from
key       : (str) The key of the data
mode      : In case we need other formats</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.parsefile.list_all">
<span class="sig-prename descclassname"><span class="pre">scifysim.parsefile.</span></span><span class="sig-name descname"><span class="pre">list_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.parsefile.list_all" title="Permalink to this definition">¶</a></dt>
<dd><p>An extra get method list all the values in the file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.parsefile.parse_file">
<span class="sig-prename descclassname"><span class="pre">scifysim.parsefile.</span></span><span class="sig-name descname"><span class="pre">parse_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.parsefile.parse_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Just a quick macro to parse the config file
file   : The path to a file</p>
</dd></dl>

</section>
<section id="module-scifysim.plot_tools">
<span id="scifysim-plot-tools-module"></span><h2>scifysim.plot_tools module<a class="headerlink" href="#module-scifysim.plot_tools" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.getcolor">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">getcolor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.getcolor" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an index to one of the basic colors of matplotlib</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.getcolortrace">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">getcolortrace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.getcolortrace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.piston2size">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">piston2size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">piston</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">140.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.piston2size" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretty visualization of projected array: Emulates perspective
dist  : The distance of the observer to the array
psz   : The diameters of the pupils
usize : A scaling parameter default = 150</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.plot_corrector_tuning_angel_woolf">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">plot_corrector_tuning_angel_woolf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corrector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combiner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.plot_corrector_tuning_angel_woolf" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots some information on the tuning of the combiner using geometric piston
and chromatic corrector plates.
Plots:
——
- Nulling contrast (before and after correction)
- The corrected matrix matrix plot
- The length of correction, compensation, and offset
- Shape excursion (before and after correction)</p>
<p>Currently works only with lambda_science_range</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.plot_injection">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">plot_injection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theinjector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.plot_injection" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides a view of the injector status.
Plots the phase screen for each pupil.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.plot_opds">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">plot_opds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.plot_opds" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the phase error information collected by 
the integrator object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.plot_phasescreen">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">plot_phasescreen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theinjector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.plot_phasescreen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.plot_projected_pupil">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">plot_projected_pupil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compass_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">140.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perspective</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.plot_projected_pupil" title="Permalink to this definition">¶</a></dt>
<dd><p>Designed as a wrapper around plot_pupil that also handles
additional illustration.
As a contrast to plot_pupil, plot_projected_pupil takes in a
simulator object.
The plots are made of the array as seen from the target in meters 
projected to RA-Dec coordinates.</p>
<p>asim    : Simulator object
seq_index: The index in the observing sequence (This feature may evolve)
grid    : Whether to plot a grid of ground position
grid_res: The number of lines in the grid for each direction
compass : Whether to plot a little North and East symbol for direction
compoass_length: In meters the length of the compass needles.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.plot_projected_uv">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">plot_projected_uv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compass_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">140.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perspective</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.plot_projected_uv" title="Permalink to this definition">¶</a></dt>
<dd><p>Designed as a wrapper around plot_pupil that also handles
additional illustration.
As a contrast to plot_pupil, plot_projected_pupil takes in a
simulator object.
The plots are made of the array as seen from the target in meters 
projected to RA-Dec coordinates.</p>
<p>asim    : Simulator object
seq_indices: The index in the observing sequence (This feature may evolve)</p>
<blockquote>
<div><p>if None: the whole sequence is mapped</p>
</div></blockquote>
<p>grid    : Whether to plot a grid of ground position
grid_res: The number of lines in the grid for each direction
compass : Whether to plot a little North and East symbol for direction
compoass_length: In meters the length of the compass needles.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.plot_pupil">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">plot_pupil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thearray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thepistons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">140.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perspective</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.plot_pupil" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the projected 
dist  : The distance of the observer to the array
psz   : The diameters of the pupils
usize : A scaling parameter default = 150
perspective: whether to simulate an effect of perspective</p>
<blockquote>
<div><p>with the size of the markers</p>
</div></blockquote>
<dl class="simple">
<dt>compass: A pair of positions indicating the direction of North and East</dt><dd><p>after transformation by the same projection as the array
[North_vector[e,n], East_vector[e,n]]</p>
</dd>
<dt>grid<span class="classifier">Similar to the compass but for a bunch of parallels and meridians</span></dt><dd><dl class="simple">
<dt>[parallels[[e0,n0], [e1, n1], … ],</dt><dd><p>meridians[[e0,n0], [e1, n1], …]]</p>
</dd>
</dl>
</dd>
</dl>
<p>Returns:
fig   : The figure</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.plot_tools.plot_response_map">
<span class="sig-prename descclassname"><span class="pre">scifysim.plot_tools.</span></span><span class="sig-name descname"><span class="pre">plot_response_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.plot_tools.plot_response_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the response map of the instrument for the target and sequence
wavelength   : np.ndarray containing wl indices (if None: use all the wavelength channels)
sequence_index : The indices of the sequence to plot
show         : Whether to call plt.show() for each plot
save         : either False or a string containing the root of a path like “maps/<a href="#id13"><span class="problematic" id="id14">figures_</span></a>”
figsize      : 2 tuple to pass to plt.figure()
dpi          : The dpi for the maps
<a href="#id9"><span class="problematic" id="id10">**</span></a>kwargs     : Additional kwargs to pass to imshow
add_central_marker: Add a marker at the 0,0 location
central_marker_size: The size parameter to give the central marker
central_marker_type: The type of marker to use</p>
</dd></dl>

</section>
<section id="module-scifysim.sources">
<span id="scifysim-sources-module"></span><h2>scifysim.sources module<a class="headerlink" href="#module-scifysim.sources" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scifysim.sources.chain">
<span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>This function helps define which occulting / emitting source
is in front ro behind which. 
A       : An upstream transmission_emission object
B       : A downstream transmission_emission object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.sources.distant_blackbody">
<span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">distant_blackbody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.distant_blackbody" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the flux density for a distant blackbody
lambda_range : Wavelenght [m]
T      : temperature [K]
dist   : Distance [pc]
radius : Star radius [R_sun]</p>
<p>Returns flux density [ph/s/m^2] arriving to earth (no atmosphere).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.sources.group">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">group</span></span><a class="headerlink" href="#scifysim.sources.group" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Just a simple object to structure some data.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.sources.resolved_source">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">resolved_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angular_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.resolved_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.resolved_source.build_grid">
<span class="sig-name descname"><span class="pre">build_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angular_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_res</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.resolved_source.build_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine used to construct resolved source:
Creates self.xx, self.yy, self.ds, self.theta, self.r</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.resolved_source.build_point">
<span class="sig-name descname"><span class="pre">build_point</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.resolved_source.build_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine used to construct unresolved source:
Creates self.xx, self.yy, self.ds, self.theta [rad], self.r [rad]
Shapes of xx, yy are preserved, but they will contain a single element
corresponding to the unresolved point source.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.resolved_source.build_spectrum_map">
<span class="sig-name descname"><span class="pre">build_spectrum_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.resolved_source.build_spectrum_map" title="Permalink to this definition">¶</a></dt>
<dd><p>The map is saved in a flat shape
xx_f and yy_f are created to be flat versions of the coordinates.
ss is a total flux (ph/s/m^2) at the entrance of earth atmosphere.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.resolved_source.distant_blackbody">
<span class="sig-name descname"><span class="pre">distant_blackbody</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.resolved_source.distant_blackbody" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the flux density for a distant blackbody
It is a total in ph/s/m2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.resolved_source.get_spectrum_map">
<span class="sig-name descname"><span class="pre">get_spectrum_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.resolved_source.get_spectrum_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps self.total_flux_density
This produces numerical integration over solid angle elements</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.sources.set_sink">
<span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">set_sink</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.set_sink" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines A as the last element in the chain.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.sources.set_source">
<span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">set_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.set_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines A as the first element in the chain.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.sources.source">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ss</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.source" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>DEPRECATED: use resolved_source for all source modelisation purposes</p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.source.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.source.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.source.sky_bg">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">sky_bg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">injector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.source.sky_bg" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRECATED: a transmission_emission object for the sky background</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.sources.src_extended">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">src_extended</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fiber_vigneting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.src_extended" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.src_extended.uniform_disk">
<span class="sig-name descname"><span class="pre">uniform_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.src_extended.uniform_disk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.sources.star_planet_target">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">star_planet_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">director</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.star_planet_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="scifysim.sources.star_planet_target.physical_separation">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">physical_separation</span></span><a class="headerlink" href="#scifysim.sources.star_planet_target.physical_separation" title="Permalink to this definition">¶</a></dt>
<dd><p>The physical separation between the planet and star (AU)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.sources.transmission_emission">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.sources.</span></span><span class="sig-name descname"><span class="pre">transmission_emission</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data/MK_trans_sfs.txt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">285</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">airmass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observatory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'noname'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.transmission_emission" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.transmission_emission.get_downstream_transmission">
<span class="sig-name descname"><span class="pre">get_downstream_transmission</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.transmission_emission.get_downstream_transmission" title="Permalink to this definition">¶</a></dt>
<dd><p>Used when chaining different media.
Returns the total of the transmission function of the chain downstream of the object.
wl   : The wavelengths to be computed
inclusive: Whether to includ the transmission of the object itself</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.transmission_emission.get_mean_trans_emit">
<span class="sig-name descname"><span class="pre">get_mean_trans_emit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.transmission_emission.get_mean_trans_emit" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar begaviour as get_trans_emit() but averages the effect over each spectral channel.
wl            : The center of each wavelength channel. If bandwidth is not provided</p>
<blockquote>
<div><p>(prefered situation) the width of each channel will be set as the spacing
between them (through np.gradient())</p>
</div></blockquote>
<p>bandwidth     : (deprecated) array of floats providing the width of each spectral channe.
n_sub         : The number of sub-channel to compute for the calculation. A minimum of 10 is recommended.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.transmission_emission.get_own_brightness">
<span class="sig-name descname"><span class="pre">get_own_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.transmission_emission.get_own_brightness" title="Permalink to this definition">¶</a></dt>
<dd><p>Used when chaining different media.
Returns the flux density per solid angle of the object in each wl channel. [ph/m2/sr]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.transmission_emission.get_own_transmission">
<span class="sig-name descname"><span class="pre">get_own_transmission</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.transmission_emission.get_own_transmission" title="Permalink to this definition">¶</a></dt>
<dd><p>Used when chaining different media.
Returns the transmission function of the object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.transmission_emission.get_total_brightness">
<span class="sig-name descname"><span class="pre">get_total_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.transmission_emission.get_total_brightness" title="Permalink to this definition">¶</a></dt>
<dd><p>Used when chaining different media.
Returns the total filtered
flux density per solid angle of the
object in each wl channel. [ph/s/m2/sr] downstream of the object (inclusively)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.transmission_emission.get_trans_emit">
<span class="sig-name descname"><span class="pre">get_trans_emit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bright</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.transmission_emission.get_trans_emit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the transmission or brightness of the object depending on th bright keyword
wl            : The wavelength channels to compute [m]
bright        : If True: compute the brightness</p>
<blockquote>
<div><p>if False: compute the transmission</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.sources.transmission_emission.get_upstream_brightness">
<span class="sig-name descname"><span class="pre">get_upstream_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.sources.transmission_emission.get_upstream_brightness" title="Permalink to this definition">¶</a></dt>
<dd><p>Used when chaining different media.
Returns the flux density per solid angle of the object in each wl channel [ph/m2/sr],
upstream of the current object (exclusively),
including the transmission by the upstream objects (exclusively)</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-scifysim.spectrograph">
<span id="scifysim-spectrograph-module"></span><h2>scifysim.spectrograph module<a class="headerlink" href="#module-scifysim.spectrograph" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="scifysim.spectrograph.basic_integrator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.spectrograph.</span></span><span class="sig-name descname"><span class="pre">basic_integrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keepall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.basic_integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.basic_integrator.accumulate">
<span class="sig-name descname"><span class="pre">accumulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.basic_integrator.accumulate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.basic_integrator.compute_noised">
<span class="sig-name descname"><span class="pre">compute_noised</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.basic_integrator.compute_noised" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.basic_integrator.compute_stats">
<span class="sig-name descname"><span class="pre">compute_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.basic_integrator.compute_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.basic_integrator.get_total">
<span class="sig-name descname"><span class="pre">get_total</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.basic_integrator.get_total" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.basic_integrator.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.basic_integrator.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.spectrograph.</span></span><span class="sig-name descname"><span class="pre">integrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infinite_well</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.accumulate">
<span class="sig-name descname"><span class="pre">accumulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.accumulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulates some signal.</p>
<p>value   : The signals to accumulate</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.compute_noised">
<span class="sig-name descname"><span class="pre">compute_noised</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.compute_noised" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.compute_stats">
<span class="sig-name descname"><span class="pre">compute_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.compute_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.consolidate_metrologic">
<span class="sig-name descname"><span class="pre">consolidate_metrologic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.consolidate_metrologic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compiles the results of metrologic exposure. 
Paramters compiled:
——————-
self.nsamples    : The number of integration steps
self.summed_signal : The total integration of</p>
<blockquote>
<div><p>all sources throughout the time steps</p>
</div></blockquote>
<dl class="simple">
<dt>self.total_summed_signal<span class="classifier">The total integration over</span></dt><dd><p>both sources and time steps</p>
</dd>
<dt>self.sums<span class="classifier">The list of signals from each of the sources</span></dt><dd><p>summed over the time steps</p>
</dd>
</dl>
<p>self.source_labels : The labels of the sources corresIFEST.in</p>
</div></blockquote>
<dl class="option-list">
<dt><kbd><span class="option">-r<var>wxrwx–x</var></span></kbd></dt>
<dd><p>1 rlaugier rlaugier 1,1K mai   27 14:50 REAponding to 
sums.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.get_planetlight">
<span class="sig-name descname"><span class="pre">get_planetlight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.get_planetlight" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.get_starlight">
<span class="sig-name descname"><span class="pre">get_starlight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.get_starlight" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.get_static">
<span class="sig-name descname"><span class="pre">get_static</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.get_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total value of integrated light from static sources.
Not affected by noises</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.get_total">
<span class="sig-name descname"><span class="pre">get_total</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectrograph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pixsplit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.get_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Made a little bit complicated by the ability to simulate CRED1 camera</p>
<dl class="simple">
<dt>spectrograph<span class="classifier">A spectrograph object to map the spectra on</span></dt><dd><p>a 2D detector</p>
</dd>
<dt>t_exp<span class="classifier">[s]  Integration time to take into account dark current</span></dt><dd><p>This is only used if self.exposure is close to 0. (if 
the )</p>
</dd>
</dl>
<p>n_pixsplit    : The number of pixels</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.prepare_t_exp_base">
<span class="sig-name descname"><span class="pre">prepare_t_exp_base</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.prepare_t_exp_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes some basic laws regarding exposure times
for the current configuration:</p>
<ul class="simple">
<li><dl class="simple">
<dt>self.expr_snr_t<span class="classifier">expression of SNR as function of time</span></dt><dd><p>which also gets printed</p>
</dd>
</dl>
</li>
<li><p>self.expr_t_for_snr   : time to get a given SNR</p></li>
<li><p>self.expr_well_fraction : Fraction of well filled by the number of Ph considered</p></li>
<li><p>self.expr_t_max       : Maximum exposure time to fill the well</p></li>
<li><p>self.t_exp_base       : lambdified version of expr_t_for_snr</p></li>
<li><p>self.snr_t            : lambdified version of expr_sr_t</p></li>
<li><p>self.well_fraction    : lambdified version of expr_well_faction</p></li>
<li><p>self.t_exp_max        : lambdified version of expr_t_max</p></li>
</ul>
<p>eta, f_planet, n_pix, f_tot, ron, =  sp.symbols(“eta, f_{planet}, n_p, f_{tot}, ron”, real=True)
n_planet, n_tot, t_exp0, t_exp = sp.symbols(“n_{planet}, n_{tot}, t_{esxp0}, t_{exp}”, real=True)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.integrator.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.integrator.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the values of the accumulation of signal in the detector.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.spectrograph.spectrograph">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.spectrograph.</span></span><span class="sig-name descname"><span class="pre">spectrograph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aconfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lamb_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_chan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.spectrograph" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.spectrograph.spectrograph.get_spectrum_image">
<span class="sig-name descname"><span class="pre">get_spectrum_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.spectrograph.spectrograph.get_spectrum_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-scifysim.utilities">
<span id="scifysim-utilities-module"></span><h2>scifysim.utilities module<a class="headerlink" href="#module-scifysim.utilities" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.Gauss">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">Gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.Gauss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.coeff">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_transmission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_sr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains the coefficients including detector integration time,
transmission, spectral channels, pixel solid angle, and quantum efficiency (default: 1.).</p>
<ul class="simple">
<li><p>dit     : detector integration time [s]</p></li>
<li><dl class="simple">
<dt>lead_transmission<span class="classifier">The transmission of the leading element (often sky) of the </span></dt><dd><p>transmission-emission chain</p>
</dd>
</dl>
</li>
<li><p>context : The spectral context of the instrument (defining the vega magnitudes)</p></li>
<li><p>eta     : (default=1.) The quantum efficiency of the detector</p></li>
<li><dl class="simple">
<dt>spectrum<span class="classifier">The type of spectrum of the object defaults to flat as opposed to the </span></dt><dd><p>temperature of Vega.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ds_sr<span class="classifier">When working with a map the solid angle of a pixel [sr]</span></dt><dd><p>Can be found in <cite>simulator.vigneting_map.ds_sr</cite> after maps have been computed</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="scifysim.utilities.ee">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">ee</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.ee" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Additional functionnality needed:
see comments starting 2021/02/24 <a class="reference external" href="https://github.com/sympy/sympy/issues/5642">https://github.com/sympy/sympy/issues/5642</a> .</p>
<dl class="py method">
<dt class="sig sig-object py" id="scifysim.utilities.ee.fprint">
<span class="sig-name descname"><span class="pre">fprint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.ee.fprint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.utilities.ee.lambdify">
<span class="sig-name descname"><span class="pre">lambdify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modules</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numexpr'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.ee.lambdify" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the lambda function. Currently, lambdification to numexpr
does not support multiple outputs, so we create a list of lambda functions.
args    : a tuple of sympy for symbols to use as inputs
modules : The module to use for computation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.utilities.ee.numexpr_call">
<span class="sig-name descname"><span class="pre">numexpr_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.ee.numexpr_call" title="Permalink to this definition">¶</a></dt>
<dd><p>The evaluation call for funcions for the numexpr case
Evaluating the list of functions and returning it as an array</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scifysim.utilities.ee.numpy_call">
<span class="sig-name descname"><span class="pre">numpy_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.ee.numpy_call" title="Permalink to this definition">¶</a></dt>
<dd><p>Just the normal call of the lambda function</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.eval_perf">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">eval_perf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">afile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetarget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrumental_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compensate_chromatic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modificators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_tqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.eval_perf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the noise profile for a given parameter file.
Parameters:
———–
- afile      : Config file 
- t_exp      : Exposure time
- n_frames   : The number of frames for MC simulation</p>
<blockquote>
<div><p>to evaluate the instrumental noise</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>instrumental_errors<span class="classifier">Bool. Whether to include instrumental</span></dt><dd><p>errors</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>seed<span class="classifier">seed to pass when generating the </span></dt><dd><p>time series of instrumental errors</p>
</dd>
</dl>
</li>
<li><p>crop       : factor to pass to the injector</p></li>
<li><dl class="simple">
<dt>target_coords<span class="classifier">Coordinates of the target </span></dt><dd><p>default:None : finds the target from catalog</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>compensate_chromatic<span class="classifier">Bool Whether to run the optimization</span></dt><dd><p>of the actuators to compensate for chromaticity
in the combiner</p>
</dd>
</dl>
</li>
<li><p>plotall    : Whether to plot a bunch of charts</p></li>
<li><dl class="simple">
<dt>use_tqdm<span class="classifier">Whether tqdm should be used at the step of the</span></dt><dd><p>MC simulations. (use false for parameter exploration)</p>
</dd>
</dl>
</li>
</ul>
<ul class="simple">
<li><p>asim       : The simulator object</p></li>
<li><p>prof       : The noise profile object</p></li>
<li><dl class="simple">
<dt>characteristics<span class="classifier">A dictionary containing a collection of</span></dt><dd><p>performance statistics</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.extract_diffobs_map">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">extract_diffobs_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.extract_diffobs_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Here in photons per dit (default=1s)</p>
<p>Parameters:
* maps     : Transmission maps for 1 ph/s/m2</p>
<blockquote>
<div><p>at the entrance of atmo</p>
</div></blockquote>
<ul class="simple">
<li><p>simulator : a sumulator object (see comments below)</p></li>
<li><p>dit      : Detector integration time [s]</p></li>
<li><p>mag      : The magnitude of a source on the map</p></li>
<li><p>postprod : A post-processing (whitening matrix)</p></li>
<li><p>eta      : The quantum efficiency of the detector</p></li>
<li><dl class="simple">
<dt>K<span class="classifier">A matrix to extract the differential</span></dt><dd><p>observable quantities (kernel matrix).
By default, the matrix is obtained from 
simulator.combiner.K</p>
</dd>
</dl>
</li>
</ul>
<p>Simulator object is used for
* The head transmission (simulator.src.sky)
* The solid angle of the pisel
* The spectral context (for the spectral channels)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.find_best_night">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">find_best_night</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.find_best_night" title="Permalink to this definition">¶</a></dt>
<dd><p>duration   [h] : duration of the observing run</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.get_header_bl_data">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">get_header_bl_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.get_header_bl_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulls the baseline infomation from the header</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.get_location">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">get_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">simple_map</span></em>, <em class="sig-param"><span class="pre">map_extent=None</span></em>, <em class="sig-param"><span class="pre">search_function=&lt;function</span> <span class="pre">argmax&gt;</span></em>, <em class="sig-param"><span class="pre">mode='polar'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.get_location" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.get_star_params">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">get_star_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.get_star_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Queries GAIA DR2 catalog for distance, radius and 
temperature of star:
star   : str   the name of the star
verbose: Whether to print the details found</p>
<p>returns:
dist [pc]   : Distance
T    [K]    : Effective temperature
R    [Rsun] : Radius</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.get_star_params_GAIA_JMMC">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">get_star_params_GAIA_JMMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showtable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.get_star_params_GAIA_JMMC" title="Permalink to this definition">¶</a></dt>
<dd><p>Queries GAIA DR2 catalog for distance, radius and 
temperature of star:
star   : str   the name of the star
verbose: Whether to print the details found</p>
<p>returns:
dist [pc]   : Distance
T    [K]    : Effective temperature
R    [Rsun] : Radius</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.get_uv">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">get_uv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">puparray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.get_uv" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the uv baselines for a given pupil configuration.
puparray    : An array representing the location of each pupil</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.lambdifyz">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">lambdifyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modules</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.lambdifyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Circumvents a bug in lambdify where silent 
variables will be simplified and therefore
aren’t broadcasted. <a class="reference external" href="https://github.com/sympy/sympy/issues/5642">https://github.com/sympy/sympy/issues/5642</a>
Use an extra argument = 0 when calling
Please, keep the function synchronous with kernuller</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.loadGRA4MAT">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">loadGRA4MAT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.loadGRA4MAT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.mag2sig">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">mag2sig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_transmission</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds_sr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.mag2sig" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains the coefficients including object magnitude, detector integration time,
transmission, spectral channels, pixel solid angle, and quantum efficiency (default: 1.).</p>
<ul class="simple">
<li><p>mag     : Magnitude of object (Vega)</p></li>
<li><p>dit     : detector integration time [s]</p></li>
<li><dl class="simple">
<dt>lead_transmission<span class="classifier">The transmission of the leading element (often sky) of the </span></dt><dd><p>transmission-emission chain</p>
</dd>
</dl>
</li>
<li><p>context : The spectral context of the instrument (defining the vega magnitudes)</p></li>
<li><p>eta     : (default=1.) The quantum efficiency of the detector</p></li>
<li><dl class="simple">
<dt>spectrum<span class="classifier">The type of spectrum of the object defaults to flat as opposed to the </span></dt><dd><p>temperature of Vega.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ds_sr<span class="classifier">When working with a map the solid angle of a pixel [sr]</span></dt><dd><p>Can be found in <cite>simulator.vigneting_map.ds_sr</cite> after maps have been computed</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.matchseries">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">matchseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmatch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.matchseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Matches series b with series a with the nmatch last samples of a and
the nmatch first samples of b.
Returns the concatenation.</p>
<p>a        : 1D array the root of the series
b        : 1D array the tail of the series 
nmatch   : integer  The number of samples used to match the mean</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.prepare_all">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">prepare_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">afile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetarget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrumental_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compensate_chromatic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modificators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.prepare_all" title="Permalink to this definition">¶</a></dt>
<dd><p>A shortcut to prepare a simulator object
Parameters:
———–
- afile      : Config file 
- thetarget  : target name to replace in config file
- instrumental_errors : Bool. Whether to include instrumental</p>
<blockquote>
<div><p>errors</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>seed<span class="classifier">seed to pass when generating the </span></dt><dd><p>time series of instrumental errors</p>
</dd>
</dl>
</li>
<li><p>crop       : factor to pass to the injector</p></li>
<li><dl class="simple">
<dt>target_coords<span class="classifier">Coordinates of the target </span></dt><dd><p>default:None : finds the target from catalog</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>compensate_chromatic<span class="classifier">Bool Whether to run the optimization</span></dt><dd><p>of the actuators to compensate for chromaticity
in the combiner</p>
</dd>
</dl>
</li>
<li><p>modificators : a dict of parameters to supersede the config file</p></li>
</ul>
<ul class="simple">
<li><p>asim        : A simulator object</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.produce_maps">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">produce_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prof</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mypfa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mypdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/tmp/R200_twinmaps_'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10800</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starmags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([2.,</span> <span class="pre">2.42105263,</span> <span class="pre">2.84210526,</span> <span class="pre">3.26315789,</span> <span class="pre">3.68421053,</span> <span class="pre">4.10526316,</span> <span class="pre">4.52631579,</span> <span class="pre">4.94736842,</span> <span class="pre">5.36842105,</span> <span class="pre">5.78947368,</span> <span class="pre">6.21052632,</span> <span class="pre">6.63157895,</span> <span class="pre">7.05263158,</span> <span class="pre">7.47368421,</span> <span class="pre">7.89473684,</span> <span class="pre">8.31578947,</span> <span class="pre">8.73684211,</span> <span class="pre">9.15789474,</span> <span class="pre">9.57894737,</span> <span class="pre">10.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">90.,</span> <span class="pre">-</span> <span class="pre">76.66666667,</span> <span class="pre">-</span> <span class="pre">63.33333333,</span> <span class="pre">-</span> <span class="pre">50.,</span> <span class="pre">-</span> <span class="pre">36.66666667,</span> <span class="pre">-</span> <span class="pre">23.33333333,</span> <span class="pre">-</span> <span class="pre">10.,</span> <span class="pre">3.33333333,</span> <span class="pre">16.66666667,</span> <span class="pre">30.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapcrop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.produce_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility macro that packages the production of multiple sensitivity
maps for a given director object and noise profile
Parameters:
———–
- asim     : Simulator director object
- prof     : Noise profile</p>
<ul class="simple">
<li><p>metamap   : T</p></li>
<li><p>themap    : The energy detector map in magnitude</p></li>
<li><p>theNPmap  : The Neyman-Pearson detector map in magnitude</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.profileit">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">profileit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.profileit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.random_series_fft">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">random_series_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchto</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchlength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.random_series_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new series of data based on the provided power spectrum.
If matchto is provided, the new series is adjusted for continuity 
to that data.
Parameters:
ps       : A power spectrum
matchto  : np.ndarray of preceding series. The mean of the first</p>
<blockquote>
<div><p>n (matchlength) values of the new series are matched
to the mean of the last n values of this array.</p>
</div></blockquote>
<p>matchlength : integer. The number of values to match 
keepall  : Boolean. If true, will return the concatenation of the</p>
<blockquote>
<div><p>new array with the old. If False, will return only the
new array.</p>
</div></blockquote>
<p>output:
a numpy ndarray of the time series</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.test_ex">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">test_ex</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.test_ex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.test_maps">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">test_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'local_config/default_R200'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GJ</span> <span class="pre">86</span> <span class="pre">A'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.test_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Testing and comparing the 2 approaches to build transmission maps.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.test_random_series">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">test_random_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.test_random_series" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.trois">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">trois</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.trois" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.update_observing_night">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">update_observing_night</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.update_observing_night" title="Permalink to this definition">¶</a></dt>
<dd><p>config               The parsed config file to modify
time      [fits format] (if None, will optimize for elevation)
duration  [h]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.update_star_params">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">update_star_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.update_star_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scifysim.utilities.vec2diag">
<span class="sig-prename descclassname"><span class="pre">scifysim.utilities.</span></span><span class="sig-name descname"><span class="pre">vec2diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#scifysim.utilities.vec2diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Replictes in sympy the np.diag functionnality to create a
diagonal matrix from a 1D vector</p>
</dd></dl>

</section>
<section id="module-contents">
<h2>Module contents<a class="headerlink" href="#module-contents" title="Permalink to this headline">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">scifysim package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#scifysim-analysis-module">scifysim.analysis module</a></li>
<li><a class="reference internal" href="#scifysim-bimorph-module">scifysim.bimorph module</a></li>
<li><a class="reference internal" href="#module-scifysim.combiner">scifysim.combiner module</a></li>
<li><a class="reference internal" href="#module-scifysim.combiners">scifysim.combiners module</a></li>
<li><a class="reference internal" href="#scifysim-confconverter-module">scifysim.confconverter module</a></li>
<li><a class="reference internal" href="#module-scifysim.control_loop">scifysim.control_loop module</a></li>
<li><a class="reference internal" href="#module-scifysim.correctors">scifysim.correctors module</a></li>
<li><a class="reference internal" href="#module-scifysim.director">scifysim.director module</a></li>
<li><a class="reference internal" href="#scifysim-dummy-module">scifysim.dummy module</a></li>
<li><a class="reference internal" href="#module-scifysim.injection">scifysim.injection module</a></li>
<li><a class="reference internal" href="#module-scifysim.map_manager">scifysim.map_manager module</a></li>
<li><a class="reference internal" href="#module-scifysim.mol_dens">scifysim.mol_dens module</a></li>
<li><a class="reference internal" href="#module-scifysim.n_air">scifysim.n_air module</a></li>
<li><a class="reference internal" href="#module-scifysim.observatory">scifysim.observatory module</a></li>
<li><a class="reference internal" href="#module-scifysim.parsefile">scifysim.parsefile module</a></li>
<li><a class="reference internal" href="#module-scifysim.plot_tools">scifysim.plot_tools module</a></li>
<li><a class="reference internal" href="#module-scifysim.sources">scifysim.sources module</a></li>
<li><a class="reference internal" href="#module-scifysim.spectrograph">scifysim.spectrograph module</a></li>
<li><a class="reference internal" href="#module-scifysim.utilities">scifysim.utilities module</a></li>
<li><a class="reference internal" href="#module-contents">Module contents</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/scifysim.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SCIFYsim 0.2.2 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">scifysim package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Romain Laugier.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html>